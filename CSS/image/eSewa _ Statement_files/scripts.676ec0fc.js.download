/*! 
 * ec-org-point v3.30.0
 * 
 * Copyright (c) 2023 eSewa Developers <developers@esewa.com.np>
 * License: eSewa
+; * Version: 3.30.0
+; */

!function(){"use strict";angular.module("organizationModule",["ui.router","esewaComponents","esewaMessages","esewaSharedApp","esewaPaymentMenuApp","esewaPaymentApp","ui.bootstrap","ngMessages","ngCookies","infinite-scroll","restangular","ngTable","ngStorage","ngCookies","ui.select","ngSanitize","esewaProfileApp","daterangepicker","n3-line-chart","base64"]).constant("ROLES",{superZone:"SUPER ZONE",esewaCenter:"ESEWA_CENTER",zone:"ZONE",point:"POINT",organizationUser:"ORGANIZATION_USER",myWaller:"MY_WALLET",sim:"SIM",approvalRequest:"APPROVAL_REQUEST",reporting:"REPORT",customer:"CUSTOMER",viewCustomer:"VIEW CUSTOMER",createCustomer:"CREATE CUSTOMER",editCustomer:"EDIT CUSTOMER",viewPoint:"VIEW POINT",createPoint:"CREATE POINT",editPoint:"EDIT POINT",createActivity:"CREATE ACTIVITY",viewActivity:"VIEW ACTIVITY",fundTransfer:"FUND TRANSFER",bankWithDraw:"BANK WITHDRAW",topUP:"TOP UP"}).config(["RestangularProvider","$sceDelegateProvider","CDNUrl",function(e){e.setBaseUrl("/api/web")}]).run(["$rootScope","$state","$localStorage","$http","AUTH_EVENTS","$location","$timeout","ROLES","LogoutService","MyRewardBalanceService","$cookies","AuthService","RegexConstant","CDNUrl","$q","ecmsg","StateConstant","$modal","CommonService","$window",function(e,t,n,o,a,i,r,s,c,l,u,d,m,g,f,p,h,w,D,v){if(e.$storage.profile={esewaId:"",username:""},e.initialRequirement={form:"",url:"",type:""},n.redirectUrl){var y=n.redirectUrl;if(delete n.redirectUrl,"airline/newsearch"===y.split("/#/")[1])r(function(){t.go(h.AIRLINES_HOME)},100);else if(y.indexOf("make_payment")>0){var I=y.split("make_payment")[1].split("/");r(function(){t.go(h.MAKE_PAYMENT,{product_code:I[1],product_name:I[2]},{reload:!0})},0)}else""!==y&&null!==y&&(v.location.href=y)}function S(){e.$storage.qrStatus="NONE",o({method:"GET",url:"api/web/auth/qr_merchant/validate"}).success(function(t){e.$storage.profile.qrStatus=t.status,e.getProfileImage(),r(function(){n.donotShowPanInfo||d.getInitialRequirements().then(function(t){if(e.initialRequirement={},t){var n=t.plain();e.initialRequirement={form:n.required_form,url:n.form_url,type:n.required_type},e.initialRequirement.form&&"PAN"===e.initialRequirement.form&&(e.isExpired=!0,E("As per regulation from Nepal Rastra Bank, agents should provide the PAN document to operate as eSewa Point. Hence, we request you to update the PAN number and document for smooth transaction.","md"))}})},500)})}e.onLogoClicked=function(){e.isLoggedIn()?t.go("main.landing"):t.go("login")},e.afterLogin=function(){u.get("authesewa")&&d.postLogin().then(function(n){var i=new function(e,t,n,o,a,i,r,s,c,l){this.username=e,this.organizationType=t,this.isPrimary=n,this.role=o,this.organizationId=a,this.isCashIn=i,this.isCashOut=r,this.isRemittance=s,this.isAgentWithdraw=c,this.isUserReg=l}(n.user_name,n.organization_type,n.is_primary,n.role,n.organization_id,n.is_cash_in,n.is_cash_out,n.remittance,n.is_agent_withdraw,n.is_user_reg);e.userAuth=i,e.$storage.profile.esewaId=n.user_name,e.$storage.user=i,n.plain().change_password_require?(t.go("change_password",{forcefulReset:!0}),e.loadMenus(),e.$storage.changePasswordRequired=!0):e.$broadcast(a.loginSuccess),r(function(){o({method:"GET",url:"/api/web/user/profile",headers:{"Content-Type":void 0,uuid:o.defaults.headers.common.uuid},data:""}).success(function(t){t?(e.$storage.profile.username=t.organization_name,e.$storage.profile.accountStatus=t.account_status||null):e.$storage.profile.username="",S(),e.countFcmNotification()}).error(function(){e.$storage.profile.username=""})},200)})};var T=u.get("authesewa");function b(){var e=u.getAll();angular.forEach(e,function(e,t){"authesewa"!==t&&"XSRF-TOKEN"!==t||u.remove(t)})}T&&(e.uuid=T.split(":")[1],r(function(){e.afterLogin()},100)),e.checkLoggedInMobile=function(){return m.mobileNo.test(e.$storage.profile.esewaId)},8002===i.port()&&(e.isDebugMode=!0),e.isLoggedIn=function(){e.userAuth=e.$storage.user;var t=e.userAuth;return angular.isDefined(t)},e.isPointUser=function(){return!!e.$storage.user&&"POINT"===e.$storage.user.organizationType},e.killSession=function(){delete e.userAuth,delete o.defaults.headers.common.uuid,delete n.status,delete n.donotShowPanInfo,delete e.$storage.user,delete e.$storage.balance,delete e.$storage.changePasswordRequired,delete e.$storage.organizationId,delete e.$storage.isAgentReportViewed,e.clearGlobalMessages(),e.isDebugMode?t.go("login"):angular.element("#logoutForm").submit()},e.logout=function(){d.logout("").then(function(){e.killSession(),b()},function(){e.killSession(),b()}),e.isDebugMode||angular.element("#logoutForm").submit()},e.$storage.changePasswordRequired&&t.go("change_password"),e.$on("$stateChangeSuccess",function(t,n,o,a){e.fromState=a.name,e.toState=n.name}),e.$on(a.loginSuccess,function(){e.loadMenus()}),e.loadMenus=function(){e.menus=[];var t;angular.isDefined(e.$storage.user)&&(t=e.$storage.user.organizationType),function(t){void 0!==t&&(t instanceof Array?angular.forEach(t,function(t){e.menus.push(t)}):e.menus.push(t));var n,o=[];angular.isDefined(e.$storage.user)&&!e.$storage.user.isPrimary&&(n=e.$storage.user.role,angular.forEach(e.menus,function(e){angular.forEach(n,function(t){e.stateName===t&&o.push(e)})}),e.menus=o)}(function(e){if(e===s.point)return[]}(t))},e.isLoggedIn()&&e.loadMenus(),e.checkAccess=function(t){var n=!1;return e.$storage.user.isPrimary?n=!0:_.forEach(e.$storage.user.roles,function(e){e!==t||n||(n=!0)}),n},e.$on(a.notAuthenticated,function(){e.killSession(),e.logout()}),e.getBalance=function(){r(function(){e.isLoggedIn()&&l.getBalance().then(function(t){e.$storage.balance=e.userBalance,e.userBalance={balance:t.balance,lienBalance:t.lien_balance,lastTransactionDate:t.last_transaction_date},l.getRewardPoints().then(function(t){e.UserRewardPoint=t.plain()},function(t){angular.isDefined(t)?e.responseMessage=t.data.message:e.responseMessage="Error while fetching Balance for user."})},function(t){angular.isDefined(t)?e.responseMessage=t.data.message:e.responseMessage="Error while fetching Balance for user."})},200)},l.getCommissionProfile().then(function(t){e.UserCommissionProfile=t.plain()},function(t){angular.isDefined(t)?e.responseMessage=t.data.message:e.responseMessage="Error while fetching profile for user."}),e.checkUserStatus=function(){n.status||o({method:"GET",url:"/api/web/auth/user/status"}).success(function(){n.status="done"}).error(function(e){e&&(n.status="done",p.error(e.error_message))})},e.isActive=function(e){return e===i.path()},e.clearGlobalMessages=function(){e.message={},e.information={},e.trustedHtml="",e.showInformation=!1,e.currentModal&&e.currentModal.dismiss(),e.loginMessage="",e.errorMessage="",e.showHomePageAdds=!1,e.successMessage=""},e.clearMessage=function(){e.clearGlobalMessages()},r(function(){var t=i.port();80!==t&&(t=":"+t),e.domainName=i.protocol()+"://"+i.host()+t,8002===i.port()&&(e.domainName=i.protocol()+"://"+i.host()+":8002"),e.$broadcast(a.socket)},3e3),e.getProfileImage=function(){var t=document.querySelector("#ACCOUNT_ICON");t&&(t.src=e.getUserIcon()),d.getProfileImage().then(function(t){t.file_name&&r(function(){var n=document.querySelector("#ACCOUNT_ICON");n&&(n.src="",function(e){var t=f.defer(),n=new Image;return n.onerror=function(){t.resolve(!1)},n.onload=function(){t.resolve(!0)},n.src=e,t.promise}(t.file_name).then(function(o){n.src=!0===o?t.file_name:e.getUserIcon()})),e.$storage.user.username&&e.checkUserStatus()},500)},function(){r(function(){t&&(t.src=e.getUserIcon())},500)})},e.getUserIcon=function(){return g.defaultAccountUrl};var C=["$scope","message","$modalInstance",function(n,o,a){e.currentModal=a,n.proceed=function(){a.close(),t.go("user.panVat.upload")},n.closeModal=function(){a.dismiss()},n.messageInfo=o,n.dontShowBanner=function(){e.$storage.donotShowPanInfo=!0}}],E=function(t,n){w.open({templateUrl:g.url+"/html/templates/init_reqirement_infomation_dialog_point_3.38.0.html",size:n,backdrop:"static",controller:C,resolve:{message:function(){return t}}}).result.then(function(){},function(){e.initialRequirement={}})};e.$on("$stateChangeStart",function(t,n){e.information={},e.message={},"PAN"!==e.initialRequirement.form||n.name.startsWith("user.panVat")||t.preventDefault()})}])}(),function(){"use strict";angular.module("organizationModule").config(["$stateProvider","$urlRouterProvider","CDNUrl",function(e,t,n){function o(e){return n.url+e}t.otherwise("/home"),e.state("login",{url:"/login",templateUrl:"authentication/views/login.html",controller:"LoginController"}).state("statement",{url:"/statement",templateUrl:o("/html/templates/v1/statement_3.51.0.0.html"),controller:"StatementController",data:{displayName:"Statement"}}).state("my_wallet",{abstract:!0,url:"/account",templateUrl:o("/html/templates/my_wallet_home_point_3.48.1.0.html")}).state("my_wallet.notification_id",{url:"/notification",templateUrl:"mywallet/views/notification_id.html",controller:"NotificationController",data:{searchParams:["notification id"],displayName:"Notification Id",icon:"icon-es-notification-ids"}}).state("my_wallet.statement",{url:"/statement",templateUrl:o("/html/templates/v1/statement_3.51.0.0.html"),controller:"StatementController",data:{searchParams:["statement","transaction history"],displayName:"Statement",icon:"icon-es-statement"}}).state("my_wallet.profile",{url:"/profile",templateUrl:"organizationhome/views/current_organization_profile.html",controller:"LoginOrganizationProfileController",data:{searchParams:["profile"],displayName:"Profile",icon:"icon-es-user"}}).state("my_wallet.device",{url:"/device",templateUrl:"/userdevices/views/user_devices.html",controller:"UserDeviceController",data:{searchParams:["my devices"],displayName:"My Device",icon:"icon-es-device-credentials"}}).state("my_wallet.activities",{url:"/activities",templateUrl:"myactivities/views/user_activity_list.html",controller:"UserActivityController",data:{searchParams:["activities","activity"],displayName:"My Activity",icon:"icon-es-user-activities"}}).state("my_wallet.my_credentials",{url:"/credentials",templateUrl:"login_credentials/views/login_credentials_list.html",controller:"LoginCredentialsController",data:{searchParams:["credentials"],displayName:"Credential",icon:"icon-es-device-credentials"}}).state("my_wallet.add_credential",{url:"/add_credentials",templateUrl:"login_credentials/views/add_login_credentials.html",controller:"AddOrganizationUsersController",data:{searchParams:["add credentials","new credentials"],displayName:"Add Credential",icon:"icon-es-device-credentials"}}).state("my_wallet.validate_token",{url:"/validate_token",templateUrl:"login_credentials/views/login_credential_token_validation.html",controller:"AddOrganizationUsersController"}).state("my_wallet.set_password",{url:"/set_password",templateUrl:"login_credentials/views/login_credential_set_password.html",controller:"AddOrganizationUsersController"}).state("my_wallet.change_mpin",{url:"/change_mpin",templateUrl:"login_credentials/views/changeMpin.html",controller:"AddOrganizationUsersController",data:{searchParams:["change mpin"],displayName:"Change MPIN",icon:"icon-es-change-mpin"}}).state("my_wallet.qr_merchant",{url:"/qr_merchant",templateUrl:o("/html/templates/qr_merchant/qr_form.html"),controller:"QRMerchantController",data:{searchParams:["qr merchant","qrmerchant"],displayName:"QR Merchant",icon:"icon-es-scan-pay"}}).state("my_wallet.qr_merchant_view",{url:"/qr_merchant_view",templateUrl:o("/html/templates/qr_merchant/merchantBusinessQR.html"),controller:"QrGenerationController"}).state("my_wallet.transactionVelocity",{url:"/transaction-velocity",templateUrl:o("/html/templates/velocity/transaction_velocity_3.38.0.html"),controller:"TransactionVelocityController",data:{searchParams:["transaction velocity","transaction limit"],displayName:"Transaction Velocity",icon:"icon-es-limit"}}).state("zones",{abstract:!0,url:"/zone",templateUrl:"client/views/zone_home_page.html"}).state("zones.zone_txn_detail",{url:"/my_organization",templateUrl:"client/views/zone_txn_report_detail.html",controller:"PointsController"}).state("zones.zone_detail",{url:"/detail",templateUrl:"client/views/zone_list.html",controller:"PointsController"}).state("zones.requested_zones",{url:"/requested_for_approval",templateUrl:"organizationapproval/views/organization_initiated_request.html",controller:"OrganizationApprovalRequestController"}).state("zones.create_zone",{url:"/create_zone",templateUrl:"organization/views/organization_create_panel.html",controller:"CreateOrganizationController"}).state("organization_clients.report",{url:"/report",templateUrl:"organizationapproval/views/organization_profile.html",controller:"OrganizationProfileController"}).state("sim",{abstract:!0,url:"/sim",templateUrl:o("/html/templates/sim_home_page_3.37.0.html")}).state("sim.sim_management",{url:"/sim_management",templateUrl:"sim/views/sim_management.html",controllerAs:"simCtrl",controller:"SimController",data:{searchParams:["sim management"],displayName:"Sim Management",icon:"icon-es-sim-mgmt"}}).state("sim.sim_report",{url:"/sim_report",templateUrl:"sim/views/sim_report.html",controller:"SimController",data:{searchParams:["sim report"],displayName:"Sim Report",icon:"icon-es-sim-report"}}).state("sim.activation_request",{url:"/:mobileNumber/activate/:simId",templateUrl:"/sim/views/sim_activation.html",controller:"SimActivationController"}).state("sim.sim_request",{url:"/sim_request",templateUrl:"sim/views/sim_request.html",controller:"SimRequestController",data:{searchParams:["sim request"],displayName:"Sim Request",icon:"icon-es-sim"}}).state("approval",{abstract:!0,template:"<ui-view/>"}).state("approval.initiated_requests",{url:"/approval_requests",templateUrl:"organizationapproval/views/organization_initiated_request.html",controller:"OrganizationApprovalRequestController"}).state("approval.profile",{url:"/approval_requests/:organizationId",templateUrl:"organizationapproval/views/organization_profile.html",controller:"OrganizationProfileController"}).state("change_password",{url:"/change_password_org?forcefulReset",templateUrl:o("/html/org/change_password_3.40.0.0.html"),controller:"ChangePasswordController",data:{searchParams:["change password"],displayName:"Change Password",icon:"icon-es-change-password"}}).state("organization",{template:"<div ui-view></div>"}).state("organization.home",{url:"/home",templateUrl:"authentication/views/login.html"}).state("main",{template:"<div ui-view></div>"}).state("main.landing",{url:"/home",templateUrl:"authentication/views/login.html"}).state("main.fundTransfer",{url:"/fund_transfer",templateUrl:"user/merchant/payments/views/bank_withdraw.html",controller:"BankController",data:{displayName:"Bank Withdraw"}}).state("withdraw",{url:"/withdraw",templateUrl:o("/html/templates/bank/withdraw_3.51.0.0.html"),controller:"WithdrawBaseController"}).state("withdraw.bankWithdraw",{url:"/bank_withdraw",templateUrl:o("/html/templates/bank/v2/org/bank_withdraw_3.51.0.0.html"),controller:"BankController",data:{searchParams:["bank withdraw"],displayName:"Bank Withdraw",icon:"icon-es-angent-withdraw"}}).state("withdraw.bankWithdraw.confirm",{templateUrl:o("/html/templates/bank/v2/bank_withdraw_confirm_3.47.0.0.html")}).state("withdraw.agentBankWithdraw",{url:"/agent_withdraw",templateUrl:o("/html/templates/bank/v2/agent_withdraw_3.51.0.0.html"),controller:"BankController",data:{searchParams:["agent bank withdraw"],displayName:"Bank Withdraw",icon:"icon-es-angent-withdraw"}}).state("withdraw.agentBankWithdraw.confirm",{templateUrl:o("/html/templates/bank/v2/bank_withdraw_confirm_3.47.0.0.html")}).state("main.wuPickup",{url:"/wu_pickup",templateUrl:"user/merchant/payments/views/wu_pickup.html",controller:"MerchantPaymentController",data:{searchParams:["western union"],displayName:"WU pickup",icon:"icon-es-western-uion"}}).state("main.wuReceive",{url:"/wu_receive",templateUrl:"user/merchant/payments/views/wu_receive.html",controller:"MerchantPaymentController",data:{searchParams:["western union"],displayName:"WU receive",icon:"icon-es-western-uion"}}).state("user_activities",{templateUrl:"user_activities/views/user_activities_home.html"}).state("user_activities.txn_activities",{url:"/login_credential/:credentialId/txn_activities",templateUrl:"user_activities/views/user_txn_activities.html",controller:"UserActivitiesController"}).state("user_activities.point_visit_activities",{url:"/login_credential/:credentialId/point_visit_activity",templateUrl:"user_activities/views/point_visit_activities.html",controller:"UserActivitiesController"}).state("user_activities.new_client_visit_activities",{url:"/login_credential/:credentialId/client_visit_activity",templateUrl:"user_activities/views/new_client_visit_activities.html",controller:"UserActivitiesController"}).state("static",{abstract:!0,template:"<div ui-view/>"}).state("static.getting_started",{url:"/getting_started",templateUrl:"shared/views/footer_static_contents.html"}).state("static.security",{url:"/security",templateUrl:"shared/views/footer_static_contents.html"}).state("static.contact_information",{url:"/contact",templateUrl:"shared/views/footer_static_contents.html"}).state("static.terms_and_conditions",{url:"/html/terms_and_conditions",templateUrl:"shared/views/footer_static_contents.html"}).state("static.privacy",{url:"/privacy_policy",templateUrl:"shared/views/footer_static_contents.html"}).state("static.reward_point",{url:"/reward_point",templateUrl:"shared/views/footer_static_contents.html"}).state("static.westernUnion",{url:"/western_union",templateUrl:"shared/views/login_page_static_content.html",controller:"StaticController"}).state("static.aboutEsewa",{url:"/about_esewa",templateUrl:"shared/views/login_page_static_content.html",controller:"StaticController"}).state("static.faqs",{url:"/faqs",templateUrl:"shared/views/login_page_static_content.html",controller:"StaticController"}).state("static.mobileApps",{url:"/mobile_apps",templateUrl:"shared/views/login_page_static_content.html",controller:"StaticController"}).state("static.smsSyntax",{url:"/sms_syntax",templateUrl:"shared/views/login_page_static_content.html",controller:"StaticController"}).state("static.rewardPoint",{url:"/reward_point",templateUrl:"shared/views/login_page_static_content.html",controller:"StaticController"}).state("mail_notification",{abstract:!0,url:"/notification",template:"<div ui-view/>"}).state("mail_notification.notification_id_activation",{url:"/activate_email?:token",templateUrl:"shared/views/mail_notification_verification.html",controller:"EmailActivationController"}).state("authentication",{abstract:!0,template:"<div ui-view/>"}).state("authentication.forgotPassword",{url:"/forgot_password",templateUrl:"authentication/views/forgot_password.html",controller:"ForgotPasswordController"}).state("authentication.validate_forgot_password",{url:"/activate/forgot_password?:token",templateUrl:"authentication/views/forgotten_password_activation.html",controller:"ForgotPasswordActivationController"}).state("credential_token_verification",{url:"/activate/signup?:token",templateUrl:"login_credentials/views/login_credential_set_password.html",controller:"LoginCredentialActivationController"}).state("esewa_report",{abstract:!0,url:"/report",templateUrl:"/reports/views/organization_report_home.html"}).state("esewa_report.esewa_center",{url:"/:parentId/esewa_center",templateUrl:"/reports/views/esewa_center.html",controller:"EsewaCenterController"}).state("esewa_report.zones",{url:"/:parentId/zones",templateUrl:"/reports/views/zone_reporting.html",controller:"ZonesReportingController"}).state("esewa_report.points",{url:"/:zoneId/points",templateUrl:"/reports/views/point_reporting.html",controller:"PointsReportingController"}).state("esewa_report.transaction",{url:"/:organizationId/transactions",templateUrl:"/reports/views/txn_reporting.html",controller:"ServiceWiseTransactionController"}).state("esewa_report.detail_Report",{url:"/:organizationId/detail_report",templateUrl:"/reports/views/agent_commission_report.html",controller:"TransactionDetailReportingController"}).state("zones.agents",{url:"/agents",templateUrl:"views/agentDetails.html",controller:"AgentDetailController"}).state("merchant",{abstract:!0,template:"<div ui-view></div>"}).state("merchant.statements",{url:"/statements",templateUrl:o("/html/templates/v1/statement_3.51.0.0.html"),controller:"StatementController",data:{displayName:"Statement"}}).state("merchant.makePayment",{url:"/make_payment/:product_code/:product_name?cashinNumber",templateUrl:o("/html/payment/payment_template_3.51.0.0.html"),controller:"MerchantPaymentController"}).state("merchant.makePayment.secondStep",{url:"/paymentDetails",templateUrl:o("/html/payment/secondStep_3.37.1.0.html")}).state("merchant.makePayment.confirm",{templateUrl:o("/html/payment/payment_confirm_3.51.0.0.html")}).state("merchant.transaction",{url:"/transaction/:txnId/:moduleId",templateUrl:o("/html/payment/transaction_details_3.51.0.0.html"),controller:"TransactionDetailController",data:{displayName:"Transaction Details"}}).state("merchant.airlines",{controller:"AirLinesController",controllerAs:"airlines",templateUrl:o("/html/templates/airline/airlines_home.html")}).state("merchant.airlines.search",{url:"/airlines/search",templateUrl:o("/html/templates/airline/airlines_search.html"),data:{displayName:"Airlines"}}).state("merchant.airlines.list",{url:"/airlines/list",templateUrl:o("/html/templates/airline/airlines_detail_list.html"),data:{displayName:"List"}}).state("merchant.airlines.passenger",{url:"/airlines/passenger",templateUrl:o("/html/templates/airline/passenger_detail.html"),data:{displayName:"Passenger Detail"}}).state("merchant.airlines.confirmation",{url:"/airlines/confirmation",templateUrl:o("/html/templates/airline/airline_confirmation.html"),data:{displayName:"Passenger Detail"}}).state("merchant.airlines.transactionDetail",{url:"/airlines/ticket/:moduleId/:txnId",templateUrl:o("/html/payment/airlines_transaction_detail_3.51.0.0.html"),data:{displayName:"Transaction Detail"}}).state("merchant.hotels",{controller:"HotelsController",templateUrl:o("/html/templates/hotel/hotel_home.html"),ncyBreadcrumb:{label:"Hotel"}}).state("merchant.hotels.search",{url:"/hotel/search",templateUrl:o("/html/templates/hotel/hotel_search.html"),data:{displayName:"Hotels"},ncyBreadcrumb:{label:"Hotel Search",parent:"merchant.hotels"}}).state("merchant.hotels.details",{url:"/hotel/details/:hotelId",templateUrl:o("/html/templates/hotel/hotel_details.html"),data:{displayName:"Hotels"},ncyBreadcrumb:{label:"Hotel Details",parent:"merchant.hotels"}}).state("merchant.hotels.confirmation",{url:"/hotel/booking-confirmation",templateUrl:o("/html/templates/hotel/booking_confirmation.html"),data:{displayName:"Hotels"},ncyBreadcrumb:{label:"Booking Confirmation",parent:"merchant.hotels"}}).state("main.cashin",{url:"/cash-in?cashinNumber",templateUrl:o("/html/templates/cashin_point_3.37.0.html"),controller:"PointEsewaCashInController",data:{searchParams:["cashin"],displayName:"Cash In",icon:"icon-es-cashin"}}).state("cashIn",{abstract:!0,url:"/confirm",templateUrl:"esewa_money_transfer/views/abstract_cashin.html"}).state("cashIn.confirm-detail",{url:"/cash-in",templateUrl:"/esewa_money_transfer/views/confirm_cash_in.html",controller:"PointEsewaCashInController"}).state("reports",{abstract:!0,url:"/report",templateUrl:o("/html/templates/org/abstract_reports_3.37.0.html"),controller:"AbstractPointReportController"}).state("reports.agent_earning_report",{url:"/agent-earning-report",templateUrl:o("/html/templates/org/agent_earning_reports_3.38.0.1.html"),controller:"AgentEarningReportController",data:{searchParams:["report"],displayName:"Agent Earning Reports",icon:"icon-es-customer"}}).state("reports.transaction_reports",{url:"/transaction-report",templateUrl:"/reports/views/transaction_summary_reports.html",controller:"PointTxnSummaryController",data:{searchParams:["transaction","summary"],displayName:"Agent Transaction Summary",icon:"icon-es-customer"}}).state("reports.product_reports",{url:"/product-reports",templateUrl:"/reports/views/product_reports.html",controller:"PointProductWiseReportController",data:{searchParams:["transaction","summary"],displayName:"Product Wise Transaction Summary",icon:"icon-es-customer"}}).state("organization_customer",{url:"/customer",templateUrl:"/shared/customers/views/customers_home.html"}).state("organization_customer.register",{url:"/register",templateUrl:"/shared/customers/views/register_customer.html",controller:"CustomerController",data:{displayName:"Register Customer"}}).state("organization_customer.token_validation",{url:"/register/:userId",templateUrl:"/shared/customers/views/customer_info_and_token_validation.html",controller:"CustomerRegistrationController"}).state("organization_customer.registered_customer_token_validation",{url:"/point-verify/:userId",templateUrl:"/shared/customers/views/registered_customer_info_and_token_validation.html",controller:"CustomerTokenVerificationController",data:{displayName:"Verification History Transaction Summary"}}).state("organization_customer.verification_history",{url:"/verification_history",templateUrl:"/shared/customers/views/customer_verification_history.html",controller:"CustomerVerificationDetailController",data:{displayName:"Verification History Transaction Summary"}}).state("organization_customer.customers_list",{url:"/my_customer",templateUrl:"/shared/customers/views/customers_list.html",controller:"CustomerDetailController",data:{searchParams:["my customer list"],displayName:"My Customer",icon:"icon-es-customer"}}).state("offers",{url:"/offers",templateUrl:o("/html/offers/generic/all_offers_3.39.0.html"),data:{searchParams:["offers"],displayName:"Offers",icon:"icon-es-offers"}}).state("batch",{url:"/bulk-topup",abstract:!0,templateUrl:"/user/merchant/payments/views/abstract_batch_uploads.html"}).state("batch.bulkUpload",{url:"/upload",controller:"BulkTopupController",templateUrl:"/user/merchant/payments/views/excel_upload.html",data:{displayName:"Bulk Topup"}}).state("batch.bulkTransfer",{url:"/product/:productCode",controller:"BulkTopupController",templateUrl:"/user/merchant/payments/views/excel_upload.html",data:{displayName:"Bulk Topup"}}).state("batch.bulkUploadList",{url:"/list",controller:"BulkTopupController",templateUrl:"/user/merchant/payments/views/batch_uploads.html",data:{displayName:"Bulk Topup"}}).state("batch.bulkUploadOne",{url:"/:batchId",controller:"BulkTopupController",templateUrl:"/user/merchant/payments/views/batch_upload_excels.html",data:{displayName:"Bulk Topup"}})}])}(),angular.module("ngTableExport",[]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|data):/)}]).directive("exportCsv",["$parse",function(e){return{restrict:"A",scope:!1,link:function(t,n,o){var a="",i={stringify:function(e){return'"'+e.replace(/^\s\s*/,"").replace(/\s*\s$/,"").replace(/"/g,'""')+'"'},generate:function(){a="";var e=n.find("tr");angular.forEach(e,function(e,t){var n=angular.element(e),o=n.find("th"),r="";n.hasClass("ng-table-filters")||(0==o.length&&(o=n.find("td")),1!=t&&(angular.forEach(o,function(e){r+=i.stringify(angular.element(e).text())+","}),r=r.slice(0,r.length-1)),a+=r+"\n")})},link:function(){return"data:text/csv;charset=UTF-8,"+encodeURIComponent(a)}};e(o.exportCsv).assign(t.$parent,i)}}}]),function(){"use strict";angular.module("organizationModule").controller("LoginController",["$rootScope","$scope","$state","AuthService","AUTH_EVENTS",function(e,t,n,o,a){t.credentials={userName:"",password:""},t.login=function(i,r){e.disableLoginSubmit=!0,o.authenticate(i,r).then(function(t){var o=new function(e,t,n,o,a){this.username=e,this.organizationType=t,this.isPrimary=n,this.role=o,this.organizationId=a}(t.user_name,t.organization_type,t.is_primary,t.role,t.organization_id);e.userAuth=o,e.$storage.profile.esewaId=t.user_name,e.$storage.user=o,e.getProfileImage(),t.plain().change_password_require?(n.go("change_password"),e.loadMenus(),e.$storage.changePasswordRequired=!0):e.$broadcast(a.loginSuccess),e.$broadcast(a.getBalanceAndRewards)},function(n){angular.isDefined(n)?(e.loginMessage=n.data.message,t.credentials={}):(t.loginMessage="The Id and Password that you entered don't match.",e.$broadcast(a.loginFailed))}).finally(function(){e.disableLoginSubmit=!1})}}])}(),function(){"use strict";angular.module("organizationModule").controller("ForgotPasswordController",["$scope","$rootScope","$state","OrganizationStateConstant","ForgotPasswordService","$timeout",function(e,t,n,o,a,i){e.password={new_password:"",confirm_new_password:""},e.showForgotPasswordFirstForm=!0,e.showForgotPasswordSecondForm=!1,e.showForgotPasswordThirdForm=!1,e.forgotPwdRegister=function(r){e.esewa_id=r,a.registerForgotPasswordId(r).then(function(a){e.forgotPassword=a,console.log(e.forgotPassword),e.typeOfMobile(r)?(e.showForgotPasswordFirstForm=!1,e.showForgotPasswordSecondForm=!0):(i(function(){t.successMessage="We have emailed you a link to reset your password. Please go through the mail."},500),n.go(o.LOGIN))},function(e){t.showInformation=!1,angular.isDefined(e)&&(e.data.message?t.errorMessage=e.data.message:t.errorMessage="Service is currently unavailable. please, try again later to set password for the credentials.")})},e.validateTokenForgotPwd=function(n){e.token=n,a.validateTokenForForgotPassword(e.esewa_id,n).then(function(t){e.tokenValidationResponse=t.plain(),e.showForgotPasswordFirstForm=!1,e.showForgotPasswordSecondForm=!1,e.showForgotPasswordThirdForm=!0},function(e){t.showInformation=!1,angular.isDefined(e)&&(e.data.message?t.errorMessage=e.data.message:t.errorMessage="Service is currently unavailable. please, try again later to set password for the credentials.")})},e.setPasswordForGotPwd=function(r){console.log(r),e.setPasswordDto={token:e.token,password:r.new_password},console.log(e.setPasswordDto),a.setPasswordForForgotPassword(e.setPasswordDto,e.esewa_id).then(function(a){e.forgotPassword=a.plain(),i(function(){t.successMessage=e.forgotPassword.message},500),n.go(o.LOGIN),t.logout()},function(e){t.showInformation=!1,angular.isDefined(e)&&(e.data.message?t.errorMessage=e.data.message:t.errorMessage="Service is currently unavailable. please, try again later to set password for the credentials.")})},e.checkPassword=function(){return e.password.new_password===e.password.confirm_new_password},e.cancel=function(){n.go(o.LOGIN)},e.typeOfMobile=function(e){return/^[9][7-8][0-9]\d{7}$/.test(e)}}])}(),function(){"use strict";angular.module("organizationModule").controller("ForgotPasswordActivationController",["$scope","ForgotPasswordService","$stateParams","$rootScope","OrganizationStateConstant","$state","$timeout",function(e,t,n,o,a,i,r){console.log(n),e.password={password:"",confirm_password:""},t.getUserNameForTokenValidation(n.token).then(function(t){e.response=t.plain(),e.userName=e.response.user_name},function(e){angular.isDefined(e)?o.error=e:o.error="Error while submiting form."}),e.setNewForgottenPassword=function(){e.setPasswordDto={token:n.token,password:e.password.password},t.setPasswordForForgotPassword(e.setPasswordDto,e.userName).then(function(e){r(function(){o.successMessage=e.plain().message},500),o.logout(),i.go(a.LOGIN)},function(e){angular.isDefined(e)?o.error=e:o.error="Error while submitting form."})},e.checkPassword=function(){return e.password.password===e.password.confirm_password},e.cancel=function(){i.go(a.LOGIN)}}])}(),function(){"use strict";angular.module("organizationModule").service("AuthService",["Restangular",function(e){var t=e.all("");this.authenticate=function(e,n){return t.one("authenticate").withHttpConfig({miniLoadingBarId:n}).customPOST("","","",{esewa_id:e.userName,password:e.password})},this.postLogin=function(){return t.one("user").one("postlogin").customGET()},this.getInitialRequirements=function(){return t.one("user").one("initial_requirements").withHttpConfig({selfHandleLoadingBar:!0}).get()},this.logout=function(t){return e.all("logout").customPOST("","","",{esewa_id:t})},this.getProfileImage=function(){return e.one("auth/profile").one("avatar").withHttpConfig({selfHandleLoadingBar:!0}).customGET()}}])}(),function(){"use strict";angular.module("organizationModule").service("LogoutService",["Restangular",function(e){this.organizationLogout=function(){return e.one("logout").customPOST()}}])}(),function(){"use strict";angular.module("organizationModule").service("ForgotPasswordService",["Restangular",function(e){var t=e.all("user");this.registerForgotPasswordId=function(e){return t.one(e+"").one("forget_password").get()},this.validateTokenForForgotPassword=function(e,n){return t.one(e+"").one("token").one(n+"").one("validate").one("forget_password").get()},this.setPasswordForForgotPassword=function(e,n){return t.one(n+"").one("forget_password").customPUT(e)},this.getUserNameForTokenValidation=function(e){return t.one("token").get({token:e})}}])}(),function(){"use strict";angular.module("organizationModule").controller("ChangePasswordController",["$scope","$state","OrganizationHomeService","$rootScope","OrganizationStateConstant","$timeout","$cookies",function(e,t,n,o,a,i,r){e.showloadingBar=!1,o.showInformation=!0,o.clearMessage(),e.forcefulReset=t.params.forcefulReset,e.initChangePassword=function(){e.passwordDto=new function(){this.oldPassword="",this.newPassword="",this.confirmNewPassword=""}},e.initChangePassword(),e.isNewPasswordAndOldPasswordSame=function(){return""!==e.passwordDto.oldPassword&&""!==e.passwordDto.newPassword&&e.passwordDto.oldPassword===e.passwordDto.newPassword},e.isNewPasswordandConfirmNewPasswordSame=function(){return""===e.passwordDto.newPassword||""===e.passwordDto.confirmNewPassword||e.passwordDto.newPassword===e.passwordDto.confirmNewPassword},e.cancelChangePassword=function(){e.passwordDto=null,t.go(a.HOME)},e.changePassword=function(s){e.showloadingBar=!0,n.changePassword(s).then(function(n){delete o.$storage.changePasswordRequired,e.response=n.plain(),i(function(){o.successMessage=e.response.message},200),t.go(a.LOGIN),o.logout()},function(t){var n;e.showloadingBar=!1,403===t.status?(o.killSession(),n=r.getAll(),angular.forEach(n,function(e,t){"authesewa"!==t&&"XSRF-TOKEN"!==t||r.remove(t)})):o.errorMessage=t.data.error_message?t.data.error_message:"Error while changing password."})}}])}(),function(){"use strict";angular.module("organizationModule").controller("OrganizationDetailController",["$scope","$modal",function(e,t){e.showOrganizationDetail=function(t){e.showOrganizationDetailDialog(t)};var n=["$scope","$modalInstance","organizationId","OrganizationProfileService",function(e,t,n,o){e.organizationId=n,e.close=function(){t.dismiss()},o.getOrganizationBasicInformation(n).then(function(t){e.organizationsBasicDetail=t.plain()},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."}),e.loadContactDetail=function(){o.getOrganizationContactInformation(n).then(function(t){e.organizationsContactDetail=t.plain()},function(t){angular.isDefined(t)?(e.contactDetailErrorMessage=t.data.message,console.log(e.contactDetailErrorMessage)):e.contactDetailErrorMessage="Error occurred while fetching data."})},e.loadContactDetail(),e.loadOwnerShipDetail=function(){o.getOrganizationOwnerShipInformation(n).then(function(t){e.organizationsOwnerShipDetail=t},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})},e.loadOwnerShipDetail()}];e.showOrganizationDetailDialog=function(e){t.open({templateUrl:"organizationhome/views/organization_detail.html",controller:n,size:"md custom-modal",resolve:{organizationId:function(){return e}}})}}])}(),function(){"use strict";angular.module("organizationModule").controller("OrganizationLandingPageController",["$scope","$rootScope","PointEsewaMoneyTransferService",function(e,t,n){t.message={},t.isPoint&&n.validateMoneyTransfer().then(function(t){e.validation=t.plain()},function(e){angular.isDefined(e)?t.error=e.data.message:t.error="Error occurred while adding Bank service."})}])}(),function(){"use strict";angular.module("organizationModule").service("OrganizationHomeService",["Restangular",function(e){var t=e.all("user");this.changePassword=function(e){return t.one("change_password").customPOST("","","",{old_password:e.oldPassword,new_password:e.newPassword})}}])}(),function(){"use strict";angular.module("organizationModule").controller("OrganizationInfoController",["$scope","OrganizationInfoService",function(e,t){e.getOrganizationType=function(){t.getOrganizationType().then(function(t){e.organizationType=t.plain()},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})},e.getOrganizationBusinessType=function(){t.getOrganizationBusinessType().then(function(t){e.businessType=t.plain()},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})}}])}(),function(){"use strict";angular.module("organizationModule").service("OrganizationInfoService",["Restangular",function(e){var t=e.all("organization");this.getOrganizationType=function(){return t.one("type").get()},this.getOrganizationBusinessType=function(){return t.one("business_type").get()}}])}(),function(){"use strict";angular.module("organizationModule").controller("OrganizationApprovalRequestController",["$scope","$rootScope","$http","NgTableParams","$state","DateFormatter",function(e,t,n,o,a,i){e.requests=!0,e.statusList=["PENDING","INCOMPLETE","APPROVE","DELETED","REJECTED","BLOCKED","PARTIALLY_MODIFIED"],e.selectedOrganizationType={id:null},e.selectedBusinessType={id:null},e.selectedStatus="PENDING",e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-5),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},e.reloadTable=function(){e.approvalRequestTable.reload()},t.ecDashboardDate&&(e.dateRange.fromDate=new Date(t.ecDashboardDate.from_date),e.dateRange.toDate=new Date(t.ecDashboardDate.to_date)),e.showLoadingIcon=!0,e.approvalRequestTable=new o({page:1,count:25},{total:0,getData:function(t,o){return e.dateRange.toDate.setHours(23,59,59,999),n({method:"GET",url:"api/web/user/organization/initiator",params:{status:"ALL"===e.selectedStatus?null:e.selectedStatus,organization_type_id:angular.isUndefined(e.selectedOrganizationType.id)?null:e.selectedOrganizationType.id,business_type_id:angular.isUndefined(e.selectedBusinessType.id)?null:e.selectedBusinessType.id,to_date:i.formatDate(e.dateRange.toDate.toISOString()),from_date:i.formatDate(e.dateRange.fromDate.toISOString()),page:o.page()-1,size:o.count()}}).then(function(t){var n=t.data;return e.approvalRequestTable.total(n.totalElements),n.content},function(){}).finally(function(){e.showLoadingIcon=!1})}})}])}(),function(){"use strict";angular.module("organizationModule").controller("OrganizationProfileController",["$scope","$rootScope","$location","$anchorScroll","$stateParams","$modal","$http","FileSaver","$state","DownloadImage","OrganizationStateConstant","CreateOrganizationService","OrganizationProfileService",function(e,t,n,o,a,i,r,s,c,l,u,d,m){t.organization={name:"",landlineNumber:"",mobileNumber:"",emailAddress:"",addressId:"",post:"",tole:"",wardNo:"",ownersCitizenshipBackSide:"",ownersPhoto:"",ownersCitizenship:""},e.showAddLoginCredentialForm=!1,m.getOrganizationBasicInformation(a.organizationId).then(function(t){e.organizationsBasicDetail=t.plain()},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."}),m.getOrganizationContactInformation(a.organizationId).then(function(t){e.organizationsContactDetail=t.plain()},function(t){angular.isDefined(t)?(e.contactDetailErrorMessage=t.data.message,console.log(e.contactDetailErrorMessage)):e.contactDetailErrorMessage="Error occurred while fetching data."}),m.getOrganizationOwnerShipInformation(a.organizationId).then(function(t){e.organizationsOwnerShipDetail=t},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."}),m.getOrganizationDocumentDetails(a.organizationId).then(function(t){e.organizationsDocumentDetail=t.plain(),angular.forEach(e.organizationsDocumentDetail,function(t){e.downloadOrgDocument(t.id).then(function(e){t.file=e.data.file})})},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."}),m.getOrganizationLogin(a.organizationId).then(function(t){e.organizationLoginDetail=t.plain(),angular.isDefined(e.organizationLoginDetail[0])&&(e.showAddLoginCredentialForm=!0)},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."}),e.downloadDocument=function(e,t,n){l.downloadImage(e,t,n)},e.zoomImage=function(t,n){e.openImageZoomDialog(t,n)};var g=["$scope","image","image_src","$modalInstance",function(e,n,o,a){e.image=n,e.image_src=o,e.cancel=function(){a.dismiss()},t.currentModal=a}];function f(){t.organizationContactInfo={contact_name:"",contact_mobile_number:"",contact_email:"",contact_landline_number:"",contact_person_post:"",is_primary:!1}}e.openImageZoomDialog=function(e,t){i.open({templateUrl:"organizationapproval/views/organization_image_zoom.html",size:"md",controller:g,resolve:{image_src:function(){return"document"===t?document.querySelector("#"+e.document_category).src:document.querySelector("#"+e.unique).src},image:function(){return e}}})},e.addOrganizationDetail=function(t){e.openAddContactDetailDialog(t,a.organizationId)},f(),e.openAddContactDetailDialog=function(e,t){i.open({templateUrl:"organizationapproval/views/organization_add_panel.html",controller:p,size:"lg custom-modal",backdrop:"static",resolve:{type:function(){return e},organizationId:function(){return t}}})};var p=["$scope","$rootScope","$modalInstance","type","OrganizationProfileService","organizationId","OrganizationOwnerShipUploadService","CreateOrganizationService",function(e,t,n,o,a,i,s,l){t.ownersPhoto="",t.ownersCitizenship="",t.ownersCitizenshipBackSide="",e.editType=o,e.organizationId=i,e.cancel=function(){n.dismiss()},t.currentModal=n,e.dismissPanel=function(){e.cancel()},e.OrganizationContactInfoForm={},e.resetContactForm=function(){e.OrganizationContactInfoForm.form_contact.$setPristine(),e.OrganizationContactInfoForm.form_contact.$setUntouched(),e.attempted=!1,f()},e.submitEditedOrganizationBasicDetail=function(t){e.organizationBasicInfoDto={organization_type_id:t.type.id,business_type_id:t.business_type.id,name:t.name,pan:t.pan,address_id:t.currentVdc,parent_id:"",tole:t.tole,ward_no:t.wardNumber},a.submitEditedOrganizationBasicInformation(e.organizationBasicInfoDto,i).then(function(t){e.basicInfoSuccessResponse=t,e.cancel(),c.reload()},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})},e.submitRemaningOrganizationContactDetail=function(n){e.organizationContactDto={name:n.contact_name,landline_number:n.contact_landline_number,mobile_number:n.contact_mobile_number,email_address:n.contact_email,is_primary:n.is_primary,post:n.post},l.submitOrganizationContactInformation(e.organizationContactDto,i).then(function(n){e.contactInfoSuccessResponse=n.plain(),e.cancel(),c.reload(),t.message=e.contactInfoSuccessResponse.message},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})},e.submitRemaningOrganizationOwnerShipDetail=function(t,n){var o="/api/web/user/organization/"+i+"/ownership",a=[];a.push(t.ownersPhoto),a.push(t.ownersCitizenship),angular.isDefined(t.ownersCitizenshipBackSide)&&null!==t.ownersCitizenshipBackSide&&a.push(t.ownersCitizenshipBackSide),s.uploadFileToUrl(t,n,a,o),c.reload(),e.cancel()},e.submitRemaningOrganizationDocumentDetail=function(t){var n="/api/web/user/organization/"+i+"/document",o=[];o.push(t.contractDocument),o.push(t.panDocument);for(var a=new FormData,s=0;s<o.length;s++)a.append("files",o[s]),a.append(o[s].name,0===s?"CONTRACT":"PAN_VAT");r.post(n,a,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(){console.log("success"),c.reload(),e.cancel()}).error(function(){console.log("failed")})}}];e.editOrganizationDetail=function(t,n){e.openEditOrganizationDetailDialog(t,n,a.organizationId)},e.openEditOrganizationDetailDialog=function(e,t,n){i.open({templateUrl:"organizationapproval/views/organization_edit_panel.html",controller:h,size:"lg",backdrop:"static",resolve:{editableInformation:function(){return e},type:function(){return t},organizationId:function(){return n}}})};var h=["$scope","$rootScope","$modalInstance","editableInformation","type","OrganizationProfileService","organizationId","OrganizationOwnerShipUploadService","$state","AddressUpdateFactory",function(e,t,n,o,a,i,s,c,l,u){e.editType=a,e.organizationId=s,"BASIC INFORMATION"===a?(e.organizationBasicInfo={name:o.name,type:o.organization_type,business_type:"",pan:o.pan},t.address={selectedZone:{},selectedDistrict:{},selectedVdc:{},wardNumber:"",tole:""},u.getPermanentAddress(o.zone_id,o.district_id,o.vdc_municipality_id,o.ward_no,o.tole),e.organization_type=o.organization_type):"CONTACT INFORMATION"===a?(e.organizationContactInfo={contact_name:o.name,contact_mobile_number:o.mobile_number,contact_landline_number:o.landline_number,contact_email:o.email_address,is_primary:o.primary,post:o.post},console.log(e.organizationContactInfo)):"OWNERSHIP INFORMATION"===a&&(e.organizationOwnerShipInfo={owner_name:o.name,owner_mobile_number:o.mobile_number,owner_email:o.email_address,owner_landline_number:o.landline_number}),e.cancel=function(){n.dismiss()},t.currentModal=n,e.dismissPanel=function(){e.cancel()},e.submitEditedOrganizationBasicDetail=function(t,n){e.organizationBasicInfoDto={organization_type_id:4,business_type_id:t.business_type.id,name:t.name,pan:t.pan,address_id:n.selectedVdc,tole:n.tole,ward_no:n.wardNumber},i.submitEditedOrganizationBasicInformation(e.organizationBasicInfoDto,s).then(function(t){e.basicInfoSuccessResponse=t,e.cancel(),l.reload()},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})},e.submitEditedOrganizationContactDetail=function(n){e.organizationContactDto={name:n.contact_name,landline_number:n.contact_landline_number,mobile_number:n.contact_mobile_number,email_address:n.contact_email,is_primary:n.is_primary,post:n.post},i.submitEditedOrganizationContactInformation(e.organizationContactDto,s,o.id).then(function(n){e.contactInfoSuccessResponse=n.plain(),e.cancel(),l.reload(),t.message=e.contactInfoSuccessResponse.message},function(t){angular.isDefined(t)?e.errorMessage=t:e.errorMessage="Error occurred while fetching data."})},e.submitEditedOrganizationOwnerShipDetail=function(t,n){var a="/api/web/user/organization/"+s+"/ownership/"+o.id,i=[];i.push(t.ownersPhoto),i.push(t.ownersCitizenship),angular.isDefined(t.ownersCitizenshipBackSide)&&null!==t.ownersCitizenshipBackSide&&i.push(t.ownersCitizenshipBackSide),c.uploadFileToUrl(t,n,i,a),l.reload(),e.cancel()},e.submitEditedOrganizationDocumentDetail=function(t){var n="/api/web/user/organization/"+s+"/document",o=[];o.push(t.contractDocument),o.push(t.panDocument);for(var a=new FormData,i=0;i<o.length;i++)a.append("files",o[i]),a.append(o[i].name,0===i?"CONTRACT":"PAN_VAT");r.post(n,a,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(){console.log("success"),l.reload(),e.cancel()}).error(function(){console.log("failed")})}}];e.organizationLogin={confirmPassword:"",password:"",userName:""},e.cancelAddLoginCredential=function(){c.go("approval.initiated_requests",{reload:!0})},e.checkPassword=function(){return e.organizationLogin.confirmPassword===e.organizationLogin.password},e.submitOrganizationLoginDetail=function(t){e.organizatinLoginDto={esewa_id:t.userName,password:t.password},d.submitOrganizationLoginCredentials(e.organizatinLoginDto,a.organizationId).then(function(t){e.loginCredentials=t,c.go("organization_clients.approval_requests")},function(t){angular.isDefined(t)?e.errorMessage=t.data.message:e.errorMessage="Error occurred while fetching data."})},e.downloadOrgDocument=function(e){return r({method:"GET",url:"/api/web/user/organization/"+a.organizationId+"/document/"+e,headers:{"Content-Type":void 0}})}}])}(),function(){"use strict";angular.module("organizationModule").service("OrganizationProfileService",["Restangular",function(e){var t=e.all("user");this.getOrganizationBasicInformation=function(e){return t.one("organization").one(e+"").get()},this.getOrganizationContactInformation=function(e){return t.one("organization").one(e+"").one("contact").get()},this.getOrganizationOwnerShipInformation=function(e){return t.one("organization").one(e+"").one("ownership").get()},this.getOrganizationDocumentDetails=function(e){return t.one("organization").one(e+"").one("document").get()},this.submitEditedOrganizationBasicInformation=function(e,n){return t.one("organization").one(n+"").customPUT(e)},this.submitEditedOrganizationContactInformation=function(e,n,o){return t.one("organization").one(n+"").one("contact").one(o+"").customPUT(e)},this.submitOrganizationContactInformation=function(){},this.getOrganizationId=function(){return t.one("organization").get()},this.getOrganizationLogin=function(e){return t.one("organization").one(e+"").one("login").getList()}}])}(),function(){"use strict";angular.module("organizationModule").controller("AddOrganizationUsersController",["$scope","$rootScope","$state","LoginCredentialService","$timeout","OrganizationStateConstant","RegexConstant","ecmsg","DefaultMessageConstant",function(e,t,n,o,a,i,r,s,c){e.showChildAccessList=!1,e.showloadingBar=!1,e.showAddCredentialsIcon=!0,e.usernameRegex=r.username,e.accessListParms=[],e.firstForm=!0,e.secondForm=!1,e.thirdForm=!1,e.genders=["MALE","FEMALE","N/A"],e.genders[0]="MALE",angular.isDefined(t.message)&&null!==t.message&&(angular.isDefined(t.message.error)&&angular.isDefined(t.message.success)?(t.message.error="",t.message.success=""):t.message=""),e.loginCredentials={new_password:"",confirm_new_password:""},o.getCredentialRoles().then(function(t){var n;e.roleList=t.plain(),n=e.roleList,e.parentRoles=[],_.forOwn(n,function(t){null===t.parent_id&&e.parentRoles.push(t)})},function(e){t.showErrorSuccessMessage(e,!0,c.ERROR_ON_SERVING_REQUEST,!1)}),e.expandAccessList=function(t){e.showChildAccessList=!e.showChildAccessList,e.accessListId=t,e.childAccessList=[],_.forEach(e.roleList,function(n){t===n.parent_id&&e.childAccessList.push(n)})},e.checkPassword=function(){return e.loginCredentials.password===e.loginCredentials.confirmPassword},e.clearCreateLoginCredentialForm=function(){},e.createAccessList=function(t,n){if(!0===n)e.accessListParms.push(t);else if(!1===n){var o=e.accessListParms.indexOf(t);o>-1&&e.accessListParms.splice(o,1)}},e.submitCreateCredentialsForm=function(r){e.selectedGender=r.gender,e.credentialDto={full_name:r.name,user_name:r.esewa_id,gender:e.selectedGender,password:"",role_id:e.accessListParms},o.addLoginCredential(e.credentialDto).then(function(o){e.disableSubmit=!1,e.successResponse=o.plain(),e.typeOfMobile(r.esewa_id)?(e.eSewaId=r.esewa_id,e.firstForm=!1,e.secondForm=!0,e.thirdForm=!1):(a(function(){t.showErrorSuccessMessage(o,!1,c.LOGIN_CREDENTIAL_CREATED,!1)},500),n.go(i.LOGIN_CREDENTIAL))},function(n){e.disableSubmit=!1,e.loginCredentials={},t.showErrorSuccessMessage(n,!0,"",!1)}).finally(function(){t.disableSubmit=!1})},e.validatePassword=function(){return e.loginCredentials.new_password===e.loginCredentials.confirm_new_password},e.validateTokenForLoginCredential=function(n){e.token=n,o.verifyLoginCredential(e.eSewaId,n).then(function(t){e.firstForm=!1,e.secondForm=!1,e.thirdForm=!0,e.loginCredentials=t.plain()},function(e){t.showErrorSuccessMessage(e,!0,c.ERROR_ON_SERVING_REQUEST,!1)})},e.alreadyHaveToken=function(){e.firstForm=!1,e.secondForm=!0,e.thirdForm=!1},e.setPasswordForLoginCredential=function(r){e.setPasswordDto={password:r.new_password,token:e.token,mpin:r.mpin},o.setPasswordForCredentials(e.eSewaId,e.setPasswordDto).then(function(o){s.info("Secondary credential has been created successfully."),n.go(i.LOGIN_CREDENTIAL),a(function(){e.loginCredentials=o.plain(),t.showErrorSuccessMessage(r,!1,"",!1)},500)},function(e){t.showErrorSuccessMessage(e,!0,c.ERROR_ON_SERVING_REQUEST,!1)})},e.typeOfMobile=function(e){return/^[9][6-8][0-9]\d{7}$/.test(e)},e.cancel=function(){n.go(i.LOGIN_CREDENTIAL)},e.setNewMPIN=function(n){e.showloadingBar=!0,o.changeMpin(n).then(function(){e.showloadingBar=!1,e.showMpinChange=!1,e.showAddCredentialForm=!1,e.passwordDto=null,t.killSession(),t.logout(),s.success("MPIN successfully changed.","")},function(n){e.showloadingBar=!1,t.showErrorSuccessMessage(n,!0,c.SERVICE_NA,!1)})},e.cancelChangeMPIN=function(){e.showMpinChange=!1,e.showAddCredentialForm=!1,e.passwordDto=null,t.message.error="",t.message.success=""}}])}(),function(){"use strict";angular.module("organizationModule").service("LoginCredentialService",["Restangular",function(e){var t=e.all("user");this.addLoginCredential=function(e){return t.one("organization_login").customPOST(e)},this.getOrganizationLoginCredentials=function(){return t.one("organization_login").getList()},this.getCredentialRoles=function(){return e.all("role").getList()},this.deleteLoginCredential=function(e){return t.one("organization_login").one(e+"/remove").customPOST()},this.verifyLoginCredential=function(e,n){return t.one(e+"").one("token").one(n+"").one("validate_credentials_token").get()},this.setPasswordForCredentials=function(t,n){return e.one(t+"").one("create_credentials_pwd").customPOST(n)},this.getUserFromToken=function(e){return t.one("token").get({token:e})},this.resendCredentialToken=function(e){return t.one("token").one("resend").customPUT(e)},this.changeMpin=function(e){return t.one("change_mpin").customPOST(e)}}])}(),function(){"use strict";angular.module("organizationModule").service("MpinService",["Restangular",function(e){var t=e.all("auth");this.resetMPIN=function(e){return t.one(e+"").all("reset_mpin").customPUT()}}])}(),function(){"use strict";angular.module("organizationModule").controller("LoginCredentialsController",["$scope","$rootScope","$state","LoginCredentialService","$location","$modal","RegexConstant","ecmsg","OrganizationStateConstant","$timeout","DefaultMessageConstant",function(e,t,n,o,a,i,r,s,c,l,u){function d(){t.error="",t.successMessage="",t.errorMessage=""}function m(){d(),e.showloadingBar=!0,o.getOrganizationLoginCredentials().then(function(t){e.showloadingBar=!1,e.loginCredentials=t.plain()},function(n){e.showloadingBar=!1,t.showErrorSuccessMessage(n,!0,u.ERROR_ON_SERVING_REQUEST,!1)})}e.tokenValidationUsername="",e.firstForm=!0,e.secondForm=!1,e.usernameRegex=r.username,m(),e.viewActivities=function(e){n.go("user_activities.txn_activities",{credentialId:e})},e.showDeleteCredential=function(t){e.openDeleteCredentialDialog(t)};var g=["$scope","$modalInstance","credentialInfo",function(e,n,a){e.credentialInfo=a,e.close=function(){n.dismiss()},e.cancel=function(){e.close()},e.deleteCredential=function(n){e.showloadingBar=!0,o.deleteLoginCredential(n).then(function(n){m(),e.response=n.plain(),t.showErrorSuccessMessage(n,!1,"",!1)},function(e){t.showErrorSuccessMessage(e,!0,u.ERROR_ON_SERVING_REQUEST,!1)}).finally(function(){e.showloadingBar=!1,e.close()})}}];e.openDeleteCredentialDialog=function(e){i.open({templateUrl:"login_credentials/views/credential_removal_dialog.html",controller:g,size:"sm custom-modal",backdrop:"static",resolve:{credentialInfo:function(){return e}}})},e.alreadyHaveToken=function(t){e.firstForm=!1,e.secondForm=!0,e.thirdForm=!1,e.tokenValidationUsername=t},e.cancel=function(){n.reload()},e.setPasswordForLoginCredential=function(a){d(),e.setPasswordDto={password:a.new_password,token:e.token,mpin:a.mpin},o.setPasswordForCredentials(e.tokenValidationUsername,e.setPasswordDto).then(function(o){s.info("Secondary credential has been created successfully."),n.go(c.LOGIN_CREDENTIAL),l(function(){e.loginCredentials=o.plain(),t.showErrorSuccessMessage(a,!1,"",!1),m(),e.firstForm=!0,e.secondForm=!1,e.thirdForm=!1},500)},function(e){t.showErrorSuccessMessage(e,!0,u.ERROR_ON_SERVING_REQUEST,!1)})},e.validateTokenForLoginCredential=function(n){d(),e.token=n,o.verifyLoginCredential(e.tokenValidationUsername,n).then(function(t){e.firstForm=!1,e.secondForm=!1,e.thirdForm=!0,e.loginCredentials=t.plain()},function(e){t.showErrorSuccessMessage(e,!0,u.ERROR_ON_SERVING_REQUEST,!1)})},e.addCredential=function(){d(),n.go("my_wallet.add_credential")},e.typeOfMobile=function(e){return r.mobileNo.test(e)},e.resendToken=function(n){d(),e.tokenDto={notification_id:n,type:"USER"},e.showloadingBar=!0,o.resendCredentialToken(e.tokenDto).then(function(n){e.response=n,e.showloadingBar=!1,l(function(){t.showErrorSuccessMessage(n,!1,u.NOTIFICATION_SENT,!1)},10)},function(n){e.showloadingBar=!1,t.showErrorSuccessMessage(n,!0,u.ERROR_ON_SERVING_REQUEST,!1)})},e.resetMpin=function(t){d(),e.esewaId=t,i.open({templateUrl:"login_credentials/views/reset_mpin.html",controller:"MpinResetController",size:"md",resolve:{esewaId:function(){return t}}})}}])}(),function(){"use strict";angular.module("organizationModule").controller("MpinResetController",["$modalInstance","$state","$scope","$rootScope","esewaId","MpinService","$timeout","ecmsg","DefaultMessageConstant",function(e,t,n,o,a,i,r,s,c){n.disableSubmitMpin=!1,n.close=function(){e.dismiss()},o.currentModal=e,n.resetMpin=function(){n.disableSubmitMpin=!0,i.resetMPIN(a).then(function(e){n.disableSubmitMpin=!1,n.response=e.plain(),s.success("MPIN reset successful. You have been sent MPIN in your mobile number.",""),n.response&&r(function(){o.successMessageForIndex=!1,o.showInformation=!1,o.showErrorSuccessMessage(e,!1,"",!1)},100),n.close()},function(e){n.disableSubmitMpin=!1,o.showInformation=!1,n.close(),s.error("MPIN reset failed",""),o.showErrorSuccessMessage(e,!0,c.SERVICE_NA,!1)})},n.cancelChangeMPIN=function(){n.close()}}])}(),function(){"use strict";angular.module("organizationModule").controller("LoginOrganizationProfileController",["$rootScope","$scope","OrganizationProfileService","$http","$modal","CDNUrl","DefaultMessageConstant",function(e,t,n,o,a,i,r){t.openQrModal=function(){a.open({templateUrl:i.url+"/html/templates/qr_merchant/qr_modal.html",controller:"QrGenerationController",size:"md"})},n.getOrganizationId().then(function(e){t.organizationId=e,t.getProfile(t.organizationId)},function(t){e.showErrorSuccessMessage(t,!0,r.ERROR_FETCHING_DATA,!1)}),t.getProfile=function(o){n.getOrganizationBasicInformation(o).then(function(e){t.organizationsBasicDetail=e.plain()},function(t){e.showErrorSuccessMessage(t,!0,r.ERROR_FETCHING_DATA,!1)}),n.getOrganizationContactInformation(o).then(function(e){t.organizationsContactDetail=e.plain()},function(e){angular.isDefined(e)?t.contactDetailErrorMessage=e.data.message:t.contactDetailErrorMessage="Error occurred while fetching data."}),n.getOrganizationOwnerShipInformation(o).then(function(e){t.organizationsOwnerShipDetail=e,angular.forEach(t.organizationsOwnerShipDetail.ownerships,function(e){angular.forEach(e.documents,function(e){t.downloadOrgDocument(e.id).then(function(t){e.file=t.data.file})})})},function(t){e.showErrorSuccessMessage(t,!0,r.ERROR_FETCHING_DATA,!1)}),n.getOrganizationDocumentDetails(o).then(function(e){t.organizationsDocumentDetail=e.plain(),angular.forEach(t.organizationsDocumentDetail.documents,function(e){t.downloadOrgDocument(e.id).then(function(t){e.file=t.data.file})})},function(t){e.showErrorSuccessMessage(t,!0,r.ERROR_FETCHING_DATA,!1)})},t.downloadOrgDocument=function(e){return o({method:"GET",url:"/api/web/user/organization/document/"+e+"/download",headers:{"Content-Type":void 0}})}}])}(),function(){"use strict";angular.module("organizationModule").controller("QRMerchantController",["$scope","$state","$rootScope","OrganizationStateConstant","QrMerchantService","LoginCredentialService","$http","$modal","CDNUrl",function(e,t,n,o,a,i,r,s,c){e.orgDetails=[],e.qrMerchantDetail=[],e.merchantTypes=[],e.businessRegistrationTypes=[],e.businessTypes=[],e.merchantCategory=[],e.municipalities=[],e.owners=[],e.loginCredentials=[],e.loginCredentialsEmail=[],e.loginCredentialsMobile=[],e.selectedOwner=[],e.multipleOwner=!0,e.qrMerchantDetail={merchant_name:"",doing_business_as:"",business_type:"",tole:"",pan_number:"",mobile_number:"",email:"",merchant_type_id:"",business_registered_with:"",merchant_business_personnel:{name:"",mobile:""},municipalities:"",owner_name:""},e.getInitialParam=function(){a.getMerchantTypes().then(function(t){e.merchantTypes=t.plain()},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0)}),a.getBusinessRegistrationTypes().then(function(t){e.businessRegistrationTypes=t.plain()},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0)}),a.getBusinessTypes().then(function(t){e.businessTypes=t.plain()},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0)}),a.getMunicipalities().then(function(t){e.municipalities=t.plain()},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0)}),a.getOwners().then(function(t){e.owners=t.plain(),e.owners.length<2&&(e.multipleOwner=!1,e.selectedOwnerId=e.owners[0].owner_id,e.selectedOwner=e.owners[0],e.qrMerchantDetail.owner_name=e.owners[0].owner_name,e.fetchOwnerDetails())},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0)}),e.fetchOwnerDetails=function(){""!==e.selectedOwner&&null!==e.selectedOwner&&(e.selectedOwnerId=e.selectedOwner.owner_id,a.getOrganizationDetails(e.selectedOwnerId).then(function(t){e.orgDetails=t.plain(),e.qrMerchantDetail={merchant_name:e.orgDetails.organization_name,doing_business_as:e.orgDetails.organization_name,pan_number:e.orgDetails.pan_vat,tole:e.orgDetails.tole,email:"",mobile_number:"",merchant_business_personnel:{name:e.orgDetails.name,mobile:e.orgDetails.mobile_number},owner_name:e.selectedOwner.owner_name.trim()},angular.forEach(e.orgDetails.documents,function(t){e.downloadOrgDocument(t.id).then(function(e){t.file=e.data.file})})},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0),t.go("user.panVat.upload")}))},i.getOrganizationLoginCredentials().then(function(t){e.loginCredentials=t.plain(),angular.forEach(e.loginCredentials,function(t){"ACTIVE"===t.login_status&&(isNaN(1*t.user_name)?e.loginCredentialsEmail.push("es_"+t.user_name):(e.loginCredentialsMobile.push(t.user_name),e.loginCredentialsEmail.push("es_"+t.user_name+"@fonepay.com"),t.is_primary&&(e.qrMerchantDetail.merchant_business_personnel.mobile=t.user_name)))})},function(e){n.showErrorSuccessMessage(e,!0,"Service is currently not available.",!0)}),a.getQRMerchantDetails(e.organizationId).then(function(t){e.merchantDetails=t.plain(),e.qrMerchantDetail.business_type=e.merchantDetails.businessType,e.qrMerchantDetail.merchant_type_id=e.merchantDetails.merchantTypeId,e.qrMerchantDetail.business_registered_with=e.merchantDetails.businessRegisteredWith,e.qrMerchantDetail.doing_business_as=e.merchantDetails.doingBusinessAs,e.qrMerchantDetail.municipalities=e.merchantDetails.municipalityId,e.qrMerchantDetail.mobile_number=e.merchantDetails.mobileNo,e.qrMerchantDetail.email=e.merchantDetails.emailId,e.qrMerchantDetail.merchant_business_personnel.name=e.merchantDetails.merchantBusinessPersonnel.name,e.qrMerchantDetail.merchant_business_personnel.mobile=e.merchantDetails.merchantBusinessPersonnel.mobileNumber})},e.getInitialParam(),e.cancel=function(){t.go(o.HOME)},e.downloadOrgDocument=function(e){return r({method:"GET",url:"/api/web/user/organization/document/"+e+"/download",headers:{"Content-Type":void 0}})};var l=["$modalInstance","$scope","QrMerchantService","$rootScope",function(e,n,o,a){n.$$phase||n.apply(),n.close=function(){e.dismiss()},n.submitQrDetails=function(){o.postQrDetails(n.qrMerchantDetail).then(function(e){a.$storage.profile.qrStatus="PENDING",a.showErrorSuccessMessage(e,!1,"",!0),n.close(),t.go("my_wallet.profile")},function(e){a.showErrorSuccessMessage(e,!0,"",!0)})},n.setInitValue=function(){angular.forEach(n.merchantTypes,function(e){e.merchantTypeId+""===n.qrMerchantDetail.merchant_type_id&&(n.merchantTypeValue=e.merchantTypeDesc)}),angular.forEach(n.businessTypes,function(e){e.businessTypeId+""===n.qrMerchantDetail.business_type&&(n.businessTypeValue=e.businessTypeName)}),angular.forEach(n.businessRegistrationTypes,function(e){e.businessRegOrgId+""===n.qrMerchantDetail.business_registered_with&&(n.businessRegValue=e.businessRegOrgName)}),angular.forEach(n.municipalities,function(e){e.id+""===n.qrMerchantDetail.municipalities&&(n.municipalityName=e.name)})}}];e.checkValue=function(){s.open({templateUrl:c.url+"/html/templates/qr_merchant/qr_form_confirmation.html",controller:l,size:"lg custom-modal",scope:e})}}])}(),function(){"use strict";angular.module("organizationModule").controller("QrGenerationController",["$scope","QrMerchantService","$modal","$modalInstance","$rootScope","$state",function(e,t,n,o,a,i){e.closeModal=function(){o.dismiss()},e.message="";var r={render:"canvas",minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"",radius:0,quiet:0,mode:0,mSize:.1,mPosX:.5,mPosY:.5,label:"no label",fontname:"sans",fontcolor:"#000",image:null};e.hideQR=!1,e.makeQRMerchant=function(){i.go("my_wallet.qr_merchant"),e.closeModal()},e.showQr=!1,e.fetchAndGenerateQR=function(){t.getQRCode().then(function(t){var n;"true"===t.success?(e.showQr=!0,e.mechant_name=t.name,e.ref_code="Merchant code : "+t.ref_no,n=t.message,r.text=n,$("#qrCode").qrcode(r)):(e.showQr=!1,e.mechant_name=t.name,e.ref_code="Merchant code : "+t.ref_no,e.message=t.message,"DECLINED"===t.status&&(e.hideQR=!0,e.message=t.message))},function(t){a.showErrorSuccessMessage(t,!0,"",!0),e.closeModal()})}}])}(),function(){"use strict";angular.module("organizationModule").service("QrMerchantService",["Restangular",function(e){var t=e.all("auth/qr_merchant"),n=e.all("auth/organization");this.getMerchantTypes=function(){return t.one("merchant/types").get()},this.getMerchantCategory=function(){return t.one("merchant/category").get()},this.getBusinessTypes=function(){return t.one("business/types").get()},this.getBusinessRegistrationTypes=function(){return t.one("business/registration/types").get()},this.getMunicipalities=function(){return t.one("municipalities").get()},this.getOwners=function(){return n.one("owner").get()},this.getOrganizationDetails=function(e){return n.one("owner").one(e+"").one("detail").get()},this.postQrDetails=function(e){return t.one("/merchant/create").customPOST(e)},this.getQRCode=function(){return t.one("merchant/qr").get()},this.getQRMerchantDetails=function(){return t.one("merchant").one("/details").get()}}])}(),function(){"use strict";angular.module("organizationModule").controller("UserActivitiesController",["$scope","$rootScope","$state","$location","$stateParams",function(e,t,n,o,a){console.log(a),t.credentialId=a.credentialId,t.isActive=function(e){return e===n.current.name},t.goToPointVisitActivities=function(e){n.go("user_activities.point_visit_activities",{credentialId:e})}}])}(),function(){"use strict";angular.module("organizationModule").controller("MyWalletStatementController",["$scope",function(e){e.checkMethod=function(){var e=!1;return _.forEachRight([1,2],function(t){1!==t||e||(console.log("sdfdsf"),e=!0)}),e}}])}(),function(){"use strict";angular.module("organizationModule").controller("NotificationController",["$scope","NotificationService","$rootScope","$modal","$timeout","$state","OrganizationStateConstant","RegexConstant","DefaultMessageConstant",function(e,t,n,o,a,i,r,s,c){function l(){e.notification={notification_id:"",notification_type:"DEFAULT"}}function u(){n.error="",n.successMessage="",n.errorMessage=""}function d(){e.showloadingBar=!0,t.getNotificationIds().then(function(t){e.showloadingBar=!1,e.notificationIds=t.plain()},function(t){e.showloadingBar=!1,n.showErrorSuccessMessage(t,!0,c.ERROR_FETCHING_DATA,!1)})}e.showAddNotificationId=!1,e.showTokenValidationForm=!1,e.showloadingBar=!1,e.usernameRegex=s.username,l(),e.addNotificationId=function(){u(),e.showAddNotificationId=!e.showAddNotificationId,e.showTokenValidationForm=!1},e.cancel=function(){e.showAddNotificationId=!1,e.showTokenValidationForm=!1},e.clearNotificationId=function(){l()},d(),e.resendNotificationToEmail=function(o){u(),e.showloadingBar=!0,t.resendNotification(o).then(function(t){e.response=t,e.showloadingBar=!1,a(function(){n.showErrorSuccessMessage(t,!1,c.NOTIFICATION_SENT,!1)},10)},function(t){e.showloadingBar=!0,n.showErrorSuccessMessage(t,!0,c.ERROR_ON_SERVING_REQUEST,!1)})},e.submitNotificationIDs=function(){n.clearGlobalMessages(),t.addNotificationId(e.notification).then(function(t){e.disableSubmit=!1,e.successResponse=t.plain(),angular.isDefined(e.notification)?(e.showAddNotificationId=!1,e.typeOfMobile(e.notification.notification_id)&&"ACTIVE"!==e.successResponse.message&&(e.showTokenValidationForm=!0),n.showErrorSuccessMessage(t,!1,"",!1),"ACTIVE"===e.successResponse.message&&n.showErrorSuccessMessage(t,!1,c.NOTIFICATION_ADDED,!1)):(i.go(r.HOME),a(function(){n.showErrorSuccessMessage(t,!1,c.NOTIFICATION_VERIFICATION,!1)},500)),d()},function(t){e.disableSubmit=!1,l(),e.showAddNotificationId=!1,n.showErrorSuccessMessage(t,!0,c.ERROR_ON_SERVING_REQUEST,!1)})},e.alreadyHaveToken=function(t){u(),e.notification={notification_id:t,notification_type:"DEFAULT"},e.showAddNotificationId=!1,e.showTokenValidationForm=!0},e.validateTokenForNotificationId=function(o){u(),e.notificationTokenValidationDto={notification_id:e.notification.notification_id,token:o},t.validateTokenForNotification(e.notificationTokenValidationDto).then(function(t){e.successResponse=t.plain(),n.showErrorSuccessMessage(t,!1,"",!1),e.showAddNotificationId=!1,e.showTokenValidationForm=!1,l(),d()},function(e){l(),n.showErrorSuccessMessage(e,!0,c.ERROR_ON_VALIDATING_TOKEN,!1)})},e.removeNotificationId=function(t){u(),e.openRemoveNotificationIdDialog(t)};var m=["$scope","$modalInstance","notificationId","$state","NotificationService","$timeout",function(e,t,o,a,i,r){e.notificationId=o,e.close=function(){t.dismiss()},e.cancel=function(){e.close()},e.deleteNotificationId=function(t){i.removeNotificationId(t).then(function(t){e.close(),e.response=t.plain(),console.log(e.response),a.reload(),r(function(){n.showErrorSuccessMessage(t,!1,"",!1)},10)},function(e){n.showErrorSuccessMessage(e,!0,c.ERROR_ON_SERVING_REQUEST,!1)})}}];e.openRemoveNotificationIdDialog=function(e){o.open({templateUrl:"mywallet/views/remove_notification_id_confirmation.html",controller:m,size:"md custom-modal",backdrop:"static",resolve:{notificationId:function(){return e}}})},e.typeOfMobile=function(e){return/^[9][7-8][0-9]\d{7}$/.test(e)}}])}(),function(){"use strict";angular.module("organizationModule").controller("UserDeviceController",["$scope","$timeout","DeviceService","$modal","$rootScope","DefaultMessageConstant",function(e,t,n,o,a,i){function r(){n.getDevices().then(function(t){e.devices=t,e.devices?0===e.devices.length&&(e.deviceNotavailableMessage="Currently devices are not available. You can add device using eSewa's mobile App."):e.deviceNotavailableMessage="Currently devices are not available. You can add device using eSewa's mobile App."},function(e){a.showErrorSuccessMessage(e,!0,i.SOMETHING_WENT_WRONG,!1)})}a.message={},r(),e.updateDevice=function(t,n,o){e.openUpdateDeviceDialog(t,n,o)},e.openUpdateDeviceDialog=function(e,t,n){o.open({templateUrl:"userdevices/views/update_confirmation_device.html",controller:s,size:"md",backdrop:"static",resolve:{id:function(){return e},type:function(){return n},deviceName:function(){return t}}})};var s=["$scope","$modalInstance","id","type","deviceName",function(e,o,s,c,l){e.device={type:c,deviceName:l,id:s},e.close=function(){o.dismiss()},e.cancel=function(){e.close()},a.currentModal=o,e.updateDevice=function(o){"remove"===c?n.deleteDevice(o).then(function(n){e.successResponse=n.plain(),r(),e.close(),t(function(){a.showInformation=!1,a.showErrorSuccessMessage(n,!1,"",!1)},500)},function(t){e.close(),a.showInformation=!1,a.showErrorSuccessMessage(t,!0,i.SOMETHING_WENT_WRONG,!1)}):"block"===c?n.updateDeviceStatus(o,"BLOCKED").then(function(n){e.successResponse=n.plain(),r(),e.close(),t(function(){a.showInformation=!1,a.showErrorSuccessMessage(n,!1,"",!1)},500)},function(t){e.close(),a.showInformation=!1,a.showErrorSuccessMessage(t,!0,i.SERVICE_NA,!1)}):n.updateDeviceStatus(o,"ACTIVE").then(function(n){e.successResponse=n.plain(),r(),e.close(),t(function(){a.showInformation=!1,a.showErrorSuccessMessage(n,!1,"",!1)},500)},function(t){e.close(),a.showInformation=!1,a.showErrorSuccessMessage(t,!0,i.SOMETHING_WENT_WRONG,!1)})}}]}])}(),function(){"use strict";angular.module("organizationModule").service("DeviceService",["Restangular",function(e){var t=e.all("user");this.getDevices=function(){return t.one("device").customGET()},this.deleteDevice=function(e){return t.one("device").one(e+"/remove").customPOST()},this.updateDeviceStatus=function(e,n){return t.one("device").one(e+"").one("status").one(n+"").customPUT()}}])}(),function(){"use strict";angular.module("organizationModule").service("MyRewardBalanceService",["Restangular",function(e){var t=e.all("user");this.getBalance=function(){return t.one("balance").get()},this.getRewardPoints=function(){return t.one("reward_point").get()},this.getCommissionProfile=function(){return t.one("commission_profile").get()}}])}(),function(){"use strict";angular.module("organizationModule").service("NotificationService",["Restangular",function(e){var t=e.all("user");this.getNotificationIds=function(){return t.one("notification").get()},this.addNotificationId=function(e){return t.one("notification").customPOST(e)},this.validateTokenForNotification=function(e){return t.one("notification").customPUT(e)},this.removeNotificationId=function(e){return t.one("notification").one(e+"/remove").customPUT()},this.resendNotification=function(e){return t.one("notification").one(e+"").one("token").one("resend").get({type:"NOTIFICATION"})}}])}(),function(){"use strict";angular.module("organizationModule").controller("ZoneController",[function(){}])}(),function(){"use strict";angular.module("organizationModule").controller("SimController",["$scope","$rootScope","OrganizationStateConstant","$state","NgTableParams","$http","DateFormatter","$modal","FileSaver","SimService",function(e,t,n,o,a,i,r,s,c,l){this.simDispatchToPoint=function(){o.go(n.SIM_DISPATCH)},e.userStatements={},e.selectedSimStatus="DISPATCHED_TO_POINT",this.searchText="";var u,d,m=new Date;e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-90),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},this.simStatus=[{key:"Available",value:"DISPATCHED_TO_POINT"},{key:"Dispatched",value:"DISPATCHED"},{key:"Activated",value:"ACTIVATED"},{key:"Requested",value:"REQUESTED"},{key:"Rejected",value:"REJECTED"},{key:"Form Collected By Zone",value:"FORM_COLLECTED_BY_ZONE"},{key:"Form Collected By SP",value:"FORM_COLLECTED_BY_SERVICE_PROVIDER"}],this.reloadTable=function(){e.simDetailTable.reload()},"POINT"===t.$storage.user.organizationType?(u="api/web/auth/sim/point/sim_detail",d="DISPATCHED_TO_POINT"):(u="api/web/auth/zone/sim",d="DISPATCHED_TO_ZONE"),e.simDetailTable=new a({page:1,count:20},{total:0,getData:function(t,n){return e.dateRange.toDate.setHours(23,59,59,999),i({method:"GET",url:u,params:{status:angular.isDefined(e.selectedSimStatus)?e.selectedSimStatus:d,searchText:angular.isDefined(e.searchText)?e.searchText:"",fromDate:r.formatDate(e.dateRange.fromDate.toISOString()),toDate:r.formatDate(e.dateRange.toDate.toISOString()),page:n.page()-1,size:n.count()}}).then(function(t){var n=t.data;return e.simDetailTable.total(n.totalResult),n.results})}}),e.getPointDetails=function(){l.getPointDetail(r.formatDate(e.dateRange.fromDate.toISOString()),r.formatDate(e.dateRange.toDate.toISOString())).then(function(t){e.pointDetail=t},function(){t.errorMessage="Error while fetching point details"})},e.getExcel=function(){e.userStatements.busy=!0,i({url:"api/web/auth/sim/point/excel",params:{status:angular.isDefined(e.selectedSimStatus)?e.selectedSimStatus:d,searchText:angular.isDefined(e.searchText)?e.searchText:"",fromDate:r.formatDate(e.dateRange.fromDate.toISOString()),toDate:r.formatDate(e.dateRange.toDate.toISOString())},method:"GET",responseType:"arraybuffer",data:"",headers:{"Content-type":"application/json",Accept:"application/vnd.ms-excel;charset=UTF-8",uuid:t.userAuth.uuid}}).success(function(t){var n=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});c.saveAs(n,"statement_"+r.formatDate(m)+".xls"),e.userStatements.busy=!1}).error(function(n){if(angular.isDefined(n)){var o=String.fromCharCode.apply(null,new Uint8Array(n)),a=JSON.parse(o);t.errorMessage=a.message}else t.errorMessage="Error occurred while generating excel.";e.userStatements.busy=!1})},e.submitSimDetail=function(e,t){o.go(n.SIM_ACTIVATION,{mobileNumber:e,simId:t})},e.pullSimFromPoint=function(t,n){e.openSimPullConfirmationDialog(t,n)},e.openSimPullConfirmationDialog=function(e,t){s.open({templateUrl:"/sim/views/sim_pull_confirmation.html",controller:g,size:"md",resolve:{simId:function(){return e},mobileNumber:function(){return t}}})};var g=["$scope","$rootScope","$modalInstance","simId","mobileNumber","$state","$timeout","SimService","OrganizationStateConstant",function(e,t,n,o,a,i,r,s,c){e.mobileNumber=a,e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},e.simPullFromPoint=function(n){e.simPullDto={simId:o,remarks:n},s.pullSimFromPoint(e.simPullDto).then(function(n){e.close(),e.response=n.plain(),i.go(c.SIM_MANAGEMENT),r(function(){t.successMessage="Sim Pulled successfully."},10)},function(n){e.close(),angular.isDefined(n)?t.errorMessage=n.data.message:t.errorMessage="Error while pulling sim from point."})}}];e.viewSimDetail=function(t){e.openSimDetailDialog(t)},e.openSimDetailDialog=function(e){s.open({templateUrl:"/sim/views/sim_detail_dialog.html",controller:f,size:"md",resolve:{simId:function(){return e}}})};var f=["$scope","$rootScope","$modalInstance","simId","$state","$timeout","SimService",function(e,t,n,o,a,i,r){e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},r.getSimDetail(o).then(function(t){e.simCustomerDetail=t.plain()},function(n){e.close(),angular.isDefined(n)?t.errorMessage=n.data.message:t.errorMessage="Error while getting sim detail."})}];e.data=[{commissionType:"range",commissionRange:[{high:100,low:10,value:2},{high:100,low:10,value:2},{high:100,low:10,value:2}]},{commissionType:"flat",commissionRange:[{high:100,low:10,value:2}]},{commissionType:"percentage",commissionRange:[{high:100,low:10,value:2}]}]}])}(),function(){"use strict";angular.module("organizationModule").controller("SimRequestController",["$scope","$rootScope","OrganizationStateConstant","$state","$modal","SimService",function(e,t,n,o,a,i){i.getSimRequestProductType().then(function(t){e.simTypeList=t.plain()},function(e){angular.isDefined(e)?t.errorMessage=e.data.message:t.errorMessage="Error while fetching sim types."}),e.simRequestConfirmation=function(e){a.open({templateUrl:"sim/views/sim_request_confirmation.html",controller:r,size:"md",backdrop:"static",resolve:{simRequestDto:function(){return e}}})};var r=["$scope","$rootScope","$modalInstance","simRequestDto",function(e,t,n,o){e.simRequestDto=o,e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},e.deleteNotificationId=function(){}}]}])}(),function(){"use strict";angular.module("organizationModule").service("SimService",["Restangular",function(e){var t=e.all("/auth/sim");this.getSimType=function(){return t.one("type").getList()},this.getPointSimActivities=function(e,n){return t.one("point").get({size:e,page:n})},this.simDispatchToPoint=function(e){return t.one("dispatch_to_point").customPOST(e)},this.getPointListForSimDispatch=function(){return e.all("user").one("organization").one("child").one("short_detail").get()},this.checkDuplicateDocument=function(e,n){return t.one("duplicate_document").get({documentType:n,documentNo:e})},this.submitSimActivationRequests=function(e,n){return t.one(e+"").one("activation_request").customPOST(n)},this.pullSimFromPoint=function(e){return t.one("pull_sim").customPOST(e)},this.getSimDetail=function(e){return t.one(e+"").one("customer_detail").get()},this.getPointDetail=function(e,n){return t.one("point").one("details").get({fromDate:e,toDate:n})}}])}(),function(){"use strict";angular.module("organizationModule").controller("SimActivationController",["$scope","$rootScope","$state","OrganizationStateConstant","SimService","$modal","$stateParams","$http","CDNUrl","OrgAddressService",function(e,t,n,o,a,i,r,s,c,l){e.mobileNumber=r.mobileNumber,e.simActivationDetail={},e.isSmartCellNumber=!(!e.mobileNumber.match(/^988\d{7}$/)&&!e.mobileNumber.match(/^961\d{7}$/)),e.minimumDob=new Date("1900-01-01"),e.getDocumentTypeForSim=function(){s.get(c.url+"/data/simDocumentType.json").success(function(t){e.documentType=t})},l.getCountries().then(function(t){e.fetchedCountries=t.plain()}),e.validateForm=function(){if(/^\d{4}\/\d{1,2}\/\d{1,2}$/.test(e.simActivationDetail.dateOfBirth)){e.dobErrMsg="";var t=e.simActivationDetail.dateOfBirth.split("/"),n=t[1],o=t[2];if(n>12||n<=0)return void(e.dobErrMsg="Invalid month");if(o<=0||o>32)return void(e.dobErrMsg="Invalid day")}else e.dobErrMsg="Incorrect format"},e.cancel=function(){n.go(o.SIM_MANAGEMENT)},e.confirmSimActivation=function(t,n,o){t.documentName=e.documentType[t.attachedDocument-1].value,e.simActivationDto={mobileNumber:r.mobileNumber,simId:r.simId,simActivationDetail:t,address:n,temporaryAddress:o},e.openSimActivationConfirmationDialog(e.simActivationDto)},e.openSimActivationConfirmationDialog=function(t){i.open({templateUrl:"/sim/views/sim_activation_confirmation.html",controller:u,size:"lg",resolve:{simActivationDetail:function(){return t.documentName=e.documentType[t.simActivationDetail.attachedDocument-1].value,t}}})};var u=["$scope","$rootScope","$modalInstance","simActivationDetail","$state","$timeout","SimService","OrganizationStateConstant",function(e,t,n,o,a,i,r,s){e.simActivationDetail=o,e.showDuplicateDocumentView=!1,e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},e.showDuplicateDocumentDetail=function(){e.showDuplicateDocumentView=!e.showDuplicateDocumentView},e.submitSimActivationRequest=function(){e.simActivationDto={firstName:e.simActivationDetail.simActivationDetail.firstName,middleName:e.simActivationDetail.simActivationDetail.middleName,lastName:e.simActivationDetail.simActivationDetail.lastName,fatherName:e.simActivationDetail.simActivationDetail.fatherOrHusbandName,grandFatherName:e.simActivationDetail.simActivationDetail.grandFatherName,email:"",nationality:"",documentType:e.simActivationDetail.simActivationDetail.attachedDocument,documentNo:e.simActivationDetail.simActivationDetail.documentNumber,issuedPlace:e.simActivationDetail.simActivationDetail.issuedFrom,issuedDate:void 0!==e.simActivationDetail.simActivationDetail.issuedDateAd?function(e){if(angular.isDefined(e)){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}return""}(e.simActivationDetail.simActivationDetail.issuedDateAd):new Date,permanentAddress:angular.isDefined(e.address.permanentOtherAddress)?e.address.permanentOtherAddress:e.simActivationDetail.address.selectedZone.value+"-"+e.simActivationDetail.address.selectedDistrict.value+"-"+e.simActivationDetail.address.selectedVdc.value+"-"+e.simActivationDetail.address.tole+"-"+e.simActivationDetail.address.wardNumber,tollStreet:"",temporaryAddress:angular.isDefined(e.temporaryAddress.otherTemporaryAddress)?e.temporaryAddress.otherTemporaryAddress:e.simActivationDetail.temporaryAddress.selectedZone.value+", "+e.simActivationDetail.temporaryAddress.selectedDistrict.value+", "+e.simActivationDetail.temporaryAddress.selectedVdc.value+", "+e.simActivationDetail.temporaryAddress.tole+"-"+e.simActivationDetail.temporaryAddress.wardNumber,remarks:e.simActivationDetail.simActivationDetail.remarks,gender:0,narration:"",documentName:e.simActivationDetail.documentName},r.submitSimActivationRequests(e.simActivationDetail.simId,e.simActivationDto).then(function(){e.close(),a.go(s.SIM_MANAGEMENT),i(function(){t.successMessage="Sim Activation request sent successfully."},10)},function(n){e.close(),angular.isDefined(n)?t.errorMessage=n.data.error_message:t.errorMessage="Error while dispatching sim."})},e.separateByDash=function(e){var t=new Date(e),n=""+(t.getMonth()+1),o=""+t.getDate(),a=t.getFullYear();return n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),[a,n,o].join("-")}}]}])}(),function(){"use strict";angular.module("organizationModule").controller("MyActivitiesController",["$scope","$rootScope","MyActivitiesService","NgTableParams","$http","$timeout","DateFormatter","$modal",function(e,t,n,o,a,i,r,s){e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-7),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},e.predefinedActivity="",e.child="",n.getPredefinedActivities().then(function(t){e.predefinedActivities=t.plain(),console.log(e.predefinedActivities)},function(t){angular.isDefined(t)?e.error=t:e.error="Error while submiting form."}),n.getAllChilds().then(function(t){e.childList=t.plain()},function(t){angular.isDefined(t)?e.error=t:e.error="Error while submiting form."}),e.reloadTable=function(){e.myactivitiesTable.reload()},e.myactivitiesTable=new o({page:1,count:20},{total:0,getData:function(n,o){return a({method:"GET",url:"api/web/user/activity",params:{predefined_activity_id:angular.isDefined(e.predefinedActivity)?e.predefinedActivity.id:null,to_date:r.formatDate(e.dateRange.toDate.toISOString()),from_date:r.formatDate(e.dateRange.fromDate.toISOString()),organization_id:angular.isDefined(e.child)?e.child.organization_id:null,page:o.page()-1,size:o.count()}}).then(function(t){var n=t.data;return e.myactivitiesTable.total(n.totalElements),n.content},function(n){e.dataLoading=!1,angular.isDefined(n)?t.error=n.data.errorMessage:t.error="Error while fetching data."})}}),e.getActivityDetail=function(t){n.getActivityDetail(t.activity_id).then(function(n){e.activityDetail=n.plain(),angular.isUndefined(e.activityDetail[0])||e.openActivityDetailDialog(t,e.activityDetail)},function(t){angular.isDefined(t)?e.error=t:e.error="Error while fetching activity detail."})},e.openActivityDetailDialog=function(e,t){s.open({templateUrl:"myactivities/views/my_activities_detail.html",controller:c,size:"md",resolve:{activity:function(){return e},activityDetail:function(){return t}}})};var c=["$scope","$modalInstance","activity","activityDetail",function(e,t,n,o){e.activityDetail=o,e.activity=n,e.close=function(){t.dismiss()},e.cancel=function(){e.close()}}];e.onFocus=function(e){i(function(){$(e.target).trigger("change")})}}])}(),function(){"use strict";angular.module("organizationModule").service("MyActivitiesService",["Restangular",function(e){var t=e.all("user");this.getPredefinedActivities=function(){return t.one("predefined_activity_id").getList()},this.getAllChilds=function(){return t.one("organization").one("child").one("short_detail").getList()},this.getActivityDetail=function(e){return t.one("activity").one(e+"").one("logs").getList()}}])}(),function(){"use strict";angular.module("organizationModule").controller("PointTxnSummaryController",["$scope","$rootScope","NgTableParams","$http","DateFormatter","$modal","PointTxnReportService",function(e,t,n,o,a,i,r){e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-7),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,999)},e.reloadTable=function(){e.pageNumber=1,e.pointTxnSummaryTable.reload(),t.error=""},e.pageNumber=1,e.decreasePageNumber=function(t){t?1*e.pageNumber>1&&(e.pageNumber=e.pageNumber-1):e.pageNumber=1*e.pageNumber+1,e.pointTxnSummaryTable.reload()},e.onPageNumberChanged=function(){angular.isNumber(1*e.pageNumber)&&0!==e.pageNumber&&(e.pageNumber<0?e.pageNumber=1:1*e.pageNumber>=111111&&(e.pageNumber=111111),e.dataloading=!0,e.pointTxnSummaryTable.reload())},e.status="ACTIVE",e.pointTxnSummaryTable=new n({page:1,count:100},{total:0,getData:function(){return o({method:"GET",url:"api/web/auth/report/point/txn_summary",params:{to_date:a.formatDate(e.dateRange.toDate.toISOString()),from_date:a.formatDate(e.dateRange.fromDate.toISOString()),page:e.pageNumber-1}}).then(function(t){var n=t.data;return e.pointTxnSummaryTable.total(n.length),function(t){var n=0,o=0,a=0,i=0,r=0,s=0,c=0;_.each(t,function(e){n+=e.total_txn_amount,o+=e.total_txn_count,a+=e.total_cashback_amount,i+=e.total_load_amount,r+=e.total_withdraw_amount,s+=e.total_p2p_received,c+=e.total_p2p_sent}),e.totalTxnAmount=Number(n),e.totalTxnCount=Number(o),e.totalCashBack=Number(a),e.totalLoad=Number(i),e.totalWithdraw=Number(r),e.totalP2PReceived=Number(s),e.totalP2PSent=Number(c)}(n),e.showNextButton=100===n.length,n},function(e){angular.isDefined(e)?t.errorMessage=e.message:t.error="Unable to fetch data."})}});var s=["$scope","$state","$modalInstance","summary",function(e,t,n,o){e.summary=o,e.type=o.body.type,e.close=function(){n.dismiss()}}];e.viewProductWiseTransactionDetail=function(e,t){r.getPointTxnDetail(e.txn_date,t).then(function(e){var n;n=new function(e,t){return{header:e,body:t}}("Total Transaction Detail.",{detail:e.plain(),type:t}),i.open({templateUrl:"/reports/views/txn_detail_modal.html",controller:s,size:"lg",resolve:{summary:function(){return n}}})})}}])}(),function(){"use strict";angular.module("organizationModule").controller("AbstractPointReportController",["$scope","$state",function(e,t){e.goToState=function(e){t.go("^."+e)}}])}(),function(){"use strict";angular.module("organizationModule").controller("PointProductWiseReportController",["$scope","$rootScope","NgTableParams","$http","DateFormatter","PointTxnReportService","$modal",function(e,t,n,o,a,i,r){e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-7),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,999)},e.reloadTable=function(){e.pageNumber=1,e.pointProductTransctionTable.reload(),t.error=""},e.pageNumber=1,e.decreasePageNumber=function(t){t?1*e.pageNumber>1&&(e.pageNumber=e.pageNumber-1):e.pageNumber=1*e.pageNumber+1,e.pointProductTransctionTable.reload()},e.onPageNumberChanged=function(){angular.isNumber(1*e.pageNumber)&&0!==e.pageNumber&&(e.pageNumber<0?e.pageNumber=1:1*e.pageNumber>=111111&&(e.pageNumber=111111),e.dataloading=!0,e.pointProductTransctionTable.reload())},e.pointProductTransctionTable=new n({page:1,count:100},{total:0,getData:function(){return o({method:"GET",url:"api/web/auth/report/point/product_wise_report",params:{to_date:a.formatDate(e.dateRange.toDate.toISOString()),from_date:a.formatDate(e.dateRange.fromDate.toISOString()),product_id:0,page:e.pageNumber-1}}).then(function(t){var n=t.data;return function(t){var n=0,o=0,a=0,i=0;_.each(t,function(e){n+=e.total_txn_amount,o+=e.total_txn_count,a+=e.total_cashback_amount,i+=e.total_cashback_count}),e.totalTxnAmount=Number(n),e.totalTxnCount=Number(o),e.totalCashBack=Number(a),e.totalLoad=Number(i)}(n),e.pointProductTransctionTable.total(n.length),e.showNextButton=100===n.length,n},function(e){angular.isDefined(e)?t.errorMessage=e.message:t.error="Unable to fetch data."})}});var s=["$scope","$state","$modalInstance","summary",function(e,t,n,o){e.summary=o,e.close=function(){n.dismiss()}}];e.viewDateWiseTransactionDetail=function(t){i.getDateWisePointTxnDetail(t.product_id,a.formatDate(e.dateRange.fromDate.toISOString()),a.formatDate(e.dateRange.toDate.toISOString()),0).then(function(e){var t;t=new function(e,t){return{header:e,body:t}}("Transaction Detail.",{detail:e.plain()}),r.open({templateUrl:"/reports/views/date_wise_txn_detail_modal.html",controller:s,size:"lg",resolve:{summary:function(){return t}}})})}}])}(),function(){"use strict";angular.module("organizationModule").service("PointTxnReportService",["Restangular",function(e){var t=e.all("auth/report");this.getPointTxnDetail=function(e,n){return t.one("point").getList("txn_detail",function(e,t){return _.merge({txn_date:e},{type:t},{page:0})}(e,n))},this.getDateWisePointTxnDetail=function(e,n,o,a){return t.one("point").one("product").one(e+"").getList("detail",function(e,t,n){return _.merge({from_date:e},{to_date:t},{page:n})}(n,o,a))}}])}(),function(){"use strict";angular.module("organizationModule").controller("ViewReportController",["$scope","$state","$rootScope","$timeout","$localStorage",function(e,t,n,o,a){if(a.isAgentReportViewed)e.showAgentReportDropDown=!a.isAgentReportViewed;else{var i=new Date;e.showAgentReportDropDown=i.getDay()<=1&&i.getHours()>=9&&i.getHours()<=12,e.showAgentReportDropDown&&o(function(){angular.element(document.getElementById("view-report-tab")).click(),a.isAgentReportViewed=!0})}}])}(),function(){"use strict";angular.module("organizationModule").controller("AgentEarningReportController",["$scope","$rootScope","NgTableParams","$http","DateFormatter","PointTxnReportService","$localStorage",function(e,t,n,o,a,i,r){e.agentReport=0,r.isAgentReportViewed=!0,e.getAgentReport=new n({page:1,count:100},{total:0,getData:function(){return o({method:"GET",url:"api/web/auth/agents/earn_report"}).then(function(t){var n=t.data||[];return e.agentReport=n[0],e.getAgentReport.total(n.length),n},function(e){angular.isDefined(e)?t.errorMessage=e.message:t.error="Unable to fetch data."})}}),e.getTotalEarning=function(e,t){return e+t}}])}(),function(){"use strict";angular.module("organizationModule").controller("FirstLoadCommissionController",["$scope","$modalInstance","$state","OrganizationStateConstant","$stateParams",function(e,t,n,o,a){e.close=function(){t.dismiss()},e.redirectToSendMoney=function(e){n.go("merchant.makePayment",Object.assign(e,{cashinNumber:a.userId}))},e.redirectToCashIn=function(){n.go("main.cashin",{cashinNumber:a.userId})},e.cancelFirstLoadRequest=function(){t.dismiss(),n.go(o.CUSTOMER_REGISTRATION)}}])}(),function(){"use strict";angular.module("organizationModule").service("FirstLoadCommissionService",["Restangular",function(e){var t=e.all("auth");this.getFirstLoadCommission=function(e,n){return t.one("first_load").one("max_commission").get({service_code:e,esewa_id:n})}}])}(),function(){"use strict";angular.module("organizationModule").service("OrgAddressService",["Restangular",function(e){var t=e.all("address");this.getZones=function(){return t.one("zone").get()},this.getProvince=function(){return t.one("province").get()},this.getDistricts=function(e){return t.all("zone").one(e+"").one("district").get()},this.getNewDistricts=function(e){return t.all("province").one(e+"").one("district").get()},this.getVdcs=function(e){return t.all("district").one(e+"").one("vdc").get()},this.getDistrict=function(e){return t.one("district").one(e+"").get()},this.getVdc=function(e,n){return t.one("district").one(e+"").one("vdc").one(n+"").get()},this.getDistrictsOnly=function(){return t.one("district").get()},this.getAllNewDistricts=function(){return t.one("province").all("district").getList()},this.getCountries=function(){return t.all("countries").getList()}}])}(),function(){"use strict";angular.module("organizationModule").service("DateTxnService",function(){this.getFormattedDate=function(e){var t=new Date(e.fromTxnDate);t.setHours(0,0,0,0);var n=new Date(e.toTxnDate);return n.setHours(23,59,59,999),{fromTxnDate:t.toISOString(),toTxnDate:n.toISOString()}},this.getFormattedDummyDate=function(){var e={fromTxnDate:new Date(0),toTxnDate:new Date};return this.getFormattedDate(e)}})}(),function(){"use strict";angular.module("organizationModule").directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(t,n,o){var a=e(o.fileModel).assign;n.bind("change",function(){t.$apply(function(){a(t,n[0].files[0])})})}}}])}(),function(){"use strict";angular.module("organizationModule").directive("requiredFile",function(){return{require:"ngModel",link:function(e,t,n,o){t.bind("change",function(){e.$apply(function(){o.$setViewValue(t.val()),o.$render()})})}}})}(),function(){"use strict";angular.module("organizationModule").controller("AddressController",["$scope","$rootScope","OrgAddressService","$timeout",function(e,t,n,o){function a(){t.address={selectedZone:"",selectedDistrict:"",selectedVdc:"",wardNumber:"",tole:""}}function i(){t.temporaryAddress={selectedZone:"",selectedDistrict:"",selectedVdc:"",wardNumber:"",tole:""}}e.showWardNumber=!1,e.showToles=!1,e.showOtherAddress=!1,t.showCurrentToles=!1,t.showCurrentWardNumber=!1,e.isMakePermanent=!1,n.getDistrictsOnly().then(function(e){t.fetchedDistrictsForDocuments=e.plain()}),n.getAllNewDistricts().then(function(e){t.fetchedDistrictsForDocuments=e.plain()}),e.getZoneOrProvince=function(){o(function(){e.customerDetail.newAddress?(e.loadAddressBy="PROVINCE",e.showProvince=!0,e.getProvinces()):(e.loadAddressBy="ZONE",e.showProvince=!1,e.getZones())},500)},e.getZones=function(){n.getZones().then(function(e){t.fetchedOldZones=e.plain()})},e.getProvinces=function(){n.getProvince().then(function(t){e.fetchedZones=t.plain()})},e.getDistrict=function(o){e.showDistrict=!0,n.getDistricts(o.id).then(function(e){t.fetchedDistricts=e.plain()})},e.getNewDistrict=function(t){e.showDistrict=!0,n.getNewDistricts(t.id).then(function(t){e.fetchedDistricts=t.plain()})},e.getVdc=function(o){e.showVdc=!0,n.getVdcs(o.id).then(function(e){t.fetchedVdcs=e.plain()})},e.getTemporaryDistrict=function(o){o&&(e.showDistrict=!0,n.getDistricts(o.id).then(function(e){t.fetchedTemporaryDistricts=e.plain()}))},e.getNewTemporaryDistrict=function(o){o&&(e.showDistrict=!0,n.getNewDistrict(o.id).then(function(e){t.fetchedTemporaryDistricts=e.plain()}))},e.getTemporaryVdc=function(o){e.showVdc=!0,n.getVdcs(o.id).then(function(e){t.fetchedTemporaryVdcs=e.plain()})},a(),i(),e.setAddress=function(t){e.showProvince="PROVINCE"===t},e.initAddress=function(t){i(),a(),e.showProvince=t,angular.isDefined(e.customerDetail)&&e.customerDetail.newAddress&&(e.showProvince=!0)},t.documentIssuedPlace={selectedDistrict:""},e.makeSameAsPermanent=function(){e.isMakePermanent?(e.currentOtherAddressCheckBox=!1,t.showOtherCurrentAddress=!1,t.sameAsPermanenst=!0,t.showCurrentToles=!0,t.showCurrentWardNumber=!0,t.showVdc=!0,t.showDistrict=!0,t.fetchedTemporaryVdcs=e.fetchedVdcs,t.fetchedTemporaryDistricts=e.fetchedDistricts,t.temporaryAddress=angular.copy(t.address)):(e.currentOtherAddressCheckBox=!0,t.showOtherCurrentAddress=!0,t.sameAsPermanenst=!t.sameAsPermanenst,t.showCurrentToles=!1,t.showCurrentWardNumber=!1,t.showVdc=!1,t.showDistrict=!1)},t.showWard=function(){t.showWardNumber=!0},t.showTole=function(){t.showToles=!0},t.showCurrentWard=function(){t.showCurrentWardNumber=!0},t.showCurrentTole=function(){t.showCurrentToles=!0},t.selectOtherAddress=function(){t.showOtherAddress=!t.showOtherAddress,t.temporaryAddress={selectedZone:"",selectedDistrict:"",selectedVdc:"",wardNumber:"",tole:""},t.sameAsPermanenst=!1},t.selectOtherCurrentAddress=function(){e.checkBoxSameAsPermanent=!1,t.showOtherCurrentAddress=!t.showOtherCurrentAddress},t.showCurrentAddress=function(){e.isMakePermanent=!0,e.makeSameAsPermanent(),e.isMakePermanent=!1}}])}(),function(){"use strict";angular.module("organizationModule").service("FileUploadService",["$http",function(e){this.uploadFileToUrlss=function(t,n){var o=new FormData;e.post(n,o,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(){console.log("success")}).error(function(){console.log("failed")})}}])}(),function(){"use strict";angular.module("organizationModule").factory("ngTableParams",["NgTableParams",function(e){return e}])}(),function(){"use strict";angular.module("organizationModule").controller("OrgDateRangeController",["$scope",function(e){e.today=new Date;var t=function(e){e.preventDefault(),e.stopPropagation()};e.openToDate=function(n){t(n),e.toDateOpened=!0,e.fromDateOpened=!1},e.openFromDate=function(n){t(n),e.fromDateOpened=!0,e.toDateOpened=!1}}])}(),function(){"use strict";angular.module("organizationModule").controller("PointTransactionDetailController",["$scope","StatementService","$stateParams","$http","$rootScope","NewTransactionDetail","AirlinePassengerDetailService",function(e,t,n,o,a,i,r){e.transactionDetails=i,e.transactionId=n.txnId,e.moduleId=n.moduleId,e.transactionDetails.requestUniqueId||t.getTxnDetails(e.transactionId,e.moduleId).then(function(t){e.transactionDetails=t.plain(),e.transactionDetails.properties.outboundFlightNumber&&(e.ticketDetails=e.transactionDetails,e.passengerDto=r.getAirlinePassengerDetail(e.ticketDetails.properties),e.ticketDetails.transaction_code=e.transactionId,e.mobileNumber=e.ticketDetails.properties.buyerPhoneNumber,e.email=e.ticketDetails.properties.buyerEmail)},function(e){angular.isDefined(e)?a.message=e.data.error_message:a.message="Error while fetching data."})}])}(),function(){"use strict";angular.module("organizationModule").controller("StaticController",["$scope","$rootScope","$state",function(e,t,n){e.staticMenus=[{url:"static.aboutEsewa",name:"About eSewa"},{url:"static.faqs",name:"FAQs"},{url:"static.mobileApps",name:"Mobile Applications"},{url:"static.smsSyntax",name:"SMS Syntax"}],e.setShowStaticContent=function(o){t.showStaticContent=!0,e.showStaticContent=!0,n.go(o)}}])}(),function(){"use strict";angular.module("organizationModule").controller("ActivationController",["$scope","ActivationService","$stateParams","$rootScope","OrganizationStateConstant","$state","$timeout",function(e,t,n,o,a,i,r){e.notificationId="",t.getNotificationEmail().then(function(t){e.response=t.plain(),e.notificationId=e.response.notification_id},function(e){angular.isDefined(e)?o.error=e:o.error="Error while submitting form."}),e.submitVerificationRequest=function(s){e.notificationIdVerificationDto={notification_id:s,token:n.token},t.verifyNotificationIDs(e.notificationIdVerificationDto).then(function(t){e.response=t.plain(),i.go(a.HOME),r(function(){o.successMessage=e.response.message},100)},function(e){angular.isDefined(e)?o.error=e:o.error="Error while submiting form."})},e.cancel=function(){i.go(a.HOME)}}])}(),function(){"use strict";angular.module("organizationModule").controller("EmailActivationController",["$scope","$rootScope","$state","$stateParams","EmailActivationService","ecmsg","$sce","$timeout","StateConstant",function(e,t,n,o,a,i,r,s,c){e.token=o.token,e.currentState=n.current.name,e.notificationId="",t.message.error="",t.targetLogin="","mail_notification.notification_id_activation"===e.currentState&&(t.isAuthenticated()?(e.notificationDto={token:e.token},a.getUserTokenActivation(e.token,"NOTIFICATION_ACTIVATION").then(function(t){e.response=t.plain(),e.response&&(e.notificationId=e.response.username)},function(){t.error="Activation link is either invalid or expired !!",n.go("login")})):(t.error="You must be logged in for this operation or open this link from logged in browser!!",n.go("login"))),e.password={password:"",confirm_password:""},e.validateToken=function(o,i){e.userInfo={token:o,notificationId:i},a.validateToken(e.userInfo).then(function(o){e.validationInfo=o.plain(),e.showValidateUser=!1,s(function(){t.success="Notification ID is activated",n.go("my_wallet.notification_id")},300)},function(e){angular.isDefined(e)&&(e.data?t.error=e.data.error_message:t.error="Service is currently unavailable. please, try again later",n.go(c.LOGIN))})},e.addNotification=function(){e.validateToken(e.token,e.notificationId)},e.cancel=function(){n.go("login")}}])}(),function(){"use strict";angular.module("organizationModule").controller("LoginCredentialActivationController",["$scope","LoginCredentialService","$stateParams","$rootScope","OrganizationStateConstant","$state","$timeout",function(e,t,n,o,a,i,r){e.credentialLoginId="",e.loginCredentials={new_password:"",confirm_new_password:""},t.getUserFromToken(n.token).then(function(t){e.response=t.plain(),e.credentialLoginId=e.response.esewa_id,console.log(e.credentialLoginId)},function(e){angular.isDefined(e)?o.errorMessage=e:o.errorMessage="Error while submitting form."}),e.setPasswordForLoginCredential=function(s){e.setPasswordDto={password:s.new_password,token:n.token},t.setPasswordForCredentials(e.credentialLoginId,e.setPasswordDto).then(function(t){e.response=t.plain(),i.go(a.LOGIN_CREDENTIAL),r(function(){o.successMessage=e.response.data.message,console.log(o.successMessage)},100)},function(e){angular.isDefined(e)?o.errorMessage=e:o.errorMessage="Error while submitting form."})},e.checkPassword=function(){return e.loginCredentials.password===e.loginCredentials.confirmPassword},e.cancel=function(){i.go(a.HOME)}}])}(),function(){"use strict";angular.module("organizationModule").controller("TxnDateRangeController",["$scope",function(e){e.today=new Date,e.todayTxnDate=new Date;var t=function(e){e.preventDefault(),e.stopPropagation()};e.openToTxnDate=function(n){t(n),e.toTxnDateOpened=!0,e.fromTxnDateOpened=!1},e.openFromTxnDate=function(n){t(n),e.fromTxnDateOpened=!0,e.toTxnDateOpened=!1}}])}(),function(){"use strict";angular.module("organizationModule").service("DateRangeService",function(){this.getFormattedDate=function(e){var t=new Date(e.fromDate);t.setHours(0,0,0,0);var n=new Date(e.toDate);return n.setHours(23,59,59,999),{fromDate:t.toISOString(),toDate:n.toISOString()}},this.getFormattedDummyDate=function(){var e={fromDate:new Date(0),toDate:new Date};return this.getFormattedDate(e)}})}(),function(){"use strict";angular.module("organizationModule").service("EmailActivationService",["Restangular",function(e){this.getUserTokenActivation=function(t,n){var o=_.merge({activation_type:n},{token:t});return e.one("token").one("validate").get(o)};var t=e.all("user").one("notification");this.addNotification=function(e){return t.customPOST(e)},this.validateToken=function(e){var n={token:e.token,notification_id:e.notificationId};return t.customPUT(n)}}])}(),function(){"use strict";angular.module("organizationModule").factory("FileSaver",[function(){return{saveAs:function(e){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=function(){return e.URL||e.webkitURL||e},n=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,a=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),i=e.webkitRequestFileSystem,r=e.requestFileSystem||i||e.mozRequestFileSystem,s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c=0,l=function(n){var o=function(){"string"==typeof n?t().revokeObjectURL(n):n.remove()};e.chrome?o():setTimeout(o,500)},u=function(e,t,n){for(var o=(t=[].concat(t)).length;o--;){var a=e["on"+t[o]];if("function"==typeof a)try{a.call(e,n||e)}catch(e){s(e)}}},d=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},m=function(s,m,g){g||(s=d(s));var f,p,h,_=this,w=s.type,D=!1,v=function(){u(_,"writestart progress write writeend".split(" "))},y=function(){if(p&&a&&"undefined"!=typeof FileReader){var n=new FileReader;return n.onloadend=function(){var e=n.result;p.location.href="data:attachment/file"+e.slice(e.search(/[,;]/)),_.readyState=_.DONE,v()},n.readAsDataURL(s),void(_.readyState=_.INIT)}(!D&&f||(f=t().createObjectURL(s)),p)?p.location.href=f:void 0===e.open(f,"_blank")&&a&&(e.location.href=f);_.readyState=_.DONE,v(),l(f)},I=function(e){return function(){if(_.readyState!==_.DONE)return e.apply(this,arguments)}},S={create:!0,exclusive:!1};if(_.readyState=_.INIT,m||(m="download"),o)return f=t().createObjectURL(s),void setTimeout(function(){var e,t;n.href=f,n.download=m,e=n,t=new MouseEvent("click"),e.dispatchEvent(t),v(),l(f),_.readyState=_.DONE});e.chrome&&w&&"application/octet-stream"!==w&&(h=s.slice||s.webkitSlice,s=h.call(s,0,s.size,"application/octet-stream"),D=!0),i&&"download"!==m&&(m+=".download"),("application/octet-stream"===w||i)&&(p=e),r?(c+=s.size,r(e.TEMPORARY,c,I(function(e){e.root.getDirectory("saved",S,I(function(e){var t=function(){e.getFile(m,S,I(function(e){e.createWriter(I(function(t){t.onwriteend=function(t){p.location.href=e.toURL(),_.readyState=_.DONE,u(_,"writeend",t),l(e)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=_["on"+e]}),t.write(s),_.abort=function(){t.abort(),_.readyState=_.DONE},_.readyState=_.WRITING}),y)}),y)};e.getFile(m,{create:!1},I(function(e){e.remove(),t()}),I(function(e){e.code===e.NOT_FOUND_ERR?t():y()}))}),y)}),y)):y()},g=m.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=d(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(g.abort=function(){this.readyState=this.DONE,u(this,"abort")},g.readyState=g.INIT=0,g.WRITING=1,g.DONE=2,g.error=g.onwritestart=g.onprogress=g.onwrite=g.onabort=g.onerror=g.onwriteend=null,function(e,t,n){return new m(e,t,n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content)}}])}(),function(){"use strict";angular.module("organizationModule").factory("DownloadImage",["FileSaver","$http",function(e,t){return{downloadImage:function(n,o,a){t({method:"GET",url:"api/web/user/organization/document/"+n,headers:{"Content-Type":void 0,Accept:"data:image/png;charset=utf-8;base64"},responseType:"arraybuffer",data:""}).then(function(t){var n=new Blob([t],{type:"image/jpeg"}),i=(window.URL||window.webkitURL).createObjectURL(n);console.log(o),document.querySelector("#"+o).src=i,a&&e.saveAs(n,o)}).then(function(e){console.log(e)})}}}])}(),function(){"use strict";angular.module("organizationModule").factory("DateFormatter",[function(){return{formatDate:function(e){var t=new Date(e),n=""+(t.getMonth()+1),o=""+t.getDate(),a=t.getFullYear();return n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),[a,n,o].join("-")}}}])}(),function(){"use strict";angular.module("organizationModule").filter("space",[function(){return function(e){return e.replace(/\_/g," ")}}])}(),function(){"use strict";angular.module("organizationModule").filter("amount",["$filter",function(e){return function(t){return t%1!=0?e("number")(_.round(t,2),2):e("number")(t,2)}}])}(),function(){"use strict";angular.module("organizationModule").filter("GenderFilter",function(){return function(e){switch(e){case"M":return"Male";case"F":return"Female";case"O":return"Other";default:return"Male"}}})}(),function(){"use strict";angular.module("organizationModule").filter("dateRange",function(){return function(e){var t=new Date(e),n=t.getDate()/7;return{0:"1st",1:"2nd",2:"3rd",3:"4th",4:"5th"}[Math.floor(n)]+" week of "+t.toLocaleString("en-us",{month:"long"})}})}(),function(){"use strict";angular.module("organizationModule").constant("OrganizationStateConstant",{HOME:"organization.home",LOGIN:"login",FORGOT_PASSWORD:"authentication.forgotPassword",LOGIN_CREDENTIAL:"my_wallet.my_credentials",LOGIN_CREDENTIAL_TOKEN_VALIDATION:"my_wallet.validate_token",LOGIN_CREDENTIAL_SET_PASSWORD:"my_wallet.set_password",ORGANIZATION_APPROVAL_REQUESTED_LIST:"organization_clients.approval_requests",ZONE_TXN_DETAIL:"zones.zone_txn_detail",CUSTOMERS_LIST:"organization_customer.customers_list",CUSTOMER_VERIFICATION_HISTORY:"organization_customer.verification_history",CUSTOMER_VERIFICATION:"organization_customer.kyc",CUSTOMER_TOKEN_VALIDATION:"organization_customer.token_validation",CUSTOMER_REGISTRATION:"organization_customer.register",CUSTOMER_KYC_FORM:"userKyc.personalDetails",CUSTOMER_VERIFICATION_REQUEST:"organization_customer.verification",UPDATE_CUSTOMER_KYC:"userKyc.personalDetails",REGISTERED_CUSTOMER_TOKEN_VALIDATION:"organization_customer.registered_customer_token_validation",SIM_MANAGEMENT:"sim.sim_management",SIM_DISPATCH:"sim.sim_dispatch",SIM_ACTIVATION:"sim.activation_request",AIRLINES_HOME:"merchant.airlines",AIRLINES_LIST:"merchant.airlines_list",AIRLINES_PASSENGER:"merchant.airlines_passenger",ESEWA_CENTER_REPORTS:"esewa_report.esewa_center",ESEWA_ZONE_REPORTS:"esewa_report.zones",ESEWA_POINT_REPORTS:"esewa_report.points",ESEWA_TRANSACTION_REPORTS:"esewa_report.transaction",ESEWA_DETAIL_TRANSACTION_REPORTS:"esewa_report.detail_Report",QR_MERCHANT:"my_wallet.qr_merchant"})}(),function(){"use strict";angular.module("organizationModule").filter("capitalize",function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}})}(),function(){"use strict";angular.module("organizationModule").service("CustomerKycUploadService",["$http","$rootScope","$state","OrganizationStateConstant","ecmsg",function(e,t,n,o,a){function i(e){switch(e){case"License":return"LICENSE";case"Citizenship":return"CTZN";case"Passport":return"PASSPORT";case"Voter Id":return"VOTERID";default:return"CTZN"}}this.addOrUpdateCutomerKyc=function(r,s,c,l,u){if(angular.isDefined(c.customerkyc.name)&&null!==c.customerkyc.name){t.first=c.customerkyc.name.$modelValue.split(" ")[0],t.second=c.customerkyc.name.$modelValue.split(" ")[1],t.last="";for(var d=3;d<=c.customerkyc.name.$modelValue.split(" ").length;d++)t.last=t.last.concat(c.customerkyc.name.$modelValue.split(" ")[d-1]," ");2===c.customerkyc.name.$modelValue.split(" ").length&&(t.last=t.second,t.second="")}var m=new FormData;m.append("first_name",t.first),m.append("middle_name",t.second),m.append("last_name",t.last),m.append("gender","Male"===c.customerkyc.gender.$modelValue?"M":"Female"===c.customerkyc.gender.$modelValue?"F":"O"),m.append("date_of_birth_bs",c.customerkyc.date_of_birth_bs),m.append("date_of_birth_ad",new Date(c.customerkyc.date_of_birth_ad)),m.append("land_line_number",c.customerkyc.landlineNumber.$modelValue||""),m.append("spouse_name",c.customerkyc.spouseName.$modelValue||""),m.append("father_name",c.customerkyc.fatherName.$modelValue),m.append("pan_number",c.customerkyc.panNumber.$modelValue||""),m.append("grand_father_name",c.customerkyc.grandFatherName.$modelValue),m.append("occupation",c.customerkyc.occupation.$modelValue),m.append("permanent_address_id",c.address.selectedVdc),m.append("permanent_address_tole",c.address.tole),m.append("permanent_address_ward_number",c.address.wardNumber),m.append("current_address_id",c.temporaryAddress.selectedVdc),m.append("current_address_tole",c.temporaryAddress.tole),m.append("current_address_ward_number",c.temporaryAddress.wardNumber),m.append("identity_issued_date",new Date(c.customerkyc.identity_issued_date)),m.append("identity_number",c.customerkyc.identity_number),m.append("identity_issued_address_id",c.customerkyc.identity_issued_address_id),m.append("bank_code",c.customerkyc.bank_code||""),m.append("account_number",c.customerkyc.account_number||"");var g=[],f=[];!function(e,t,n,o){for(var a=0;a<e.length;a++)0===a?(n.push("IMAGE"),o.push(!!t.profilePhotoIdentityNo&&t.profilePhotoIdentityNo)):1===a?(n.push(i(t.customerkyc.filetype)),o.push(!!t.otherIdIdentityNo&&t.otherIdIdentityNo)):(n.push("OTHER"),o.push(!!t.citizenshipIdentityNo&&t.citizenshipIdentityNo))}(l,c,g,f);for(var p=0;p<l.length;p++){var h=l[p].fileType,_=l[p].documentType,w=f[p],D=h||_;D?m.append("files",l[p].file[0]):m.append("files",l[p]),D?l[p].documentType&&("otherId"===l[p].documentType?m.append("fileType","OTHER"):"profilePhoto"===l[p].documentType?m.append("fileType","IMAGE"):m.append("fileType",i(c.customerkyc.filetype))):(m.append("fileType",g[p]),"CTZN"===l[p].fileType&&l[p].fileType!==i(c.customerkyc.filetype)&&m.set("fileType",i(c.customerkyc.filetype))),l[p].documentId?m.append("identityNo",l[p].documentId):w&&m.append("identityNo",w)}return e({method:s,url:r,transformRequest:angular.identity,headers:{"Content-Type":void 0,fileType:g},data:m}).then(function(){n.go(o.CUSTOMER_VERIFICATION_REQUEST,{userId:u}),t.showloadingBar=!0,t.closeModel()},function(e){var n;t.closeModel(),n=angular.isDefined(e)?e.data.message||e.data.error_message:"Error occurred while uploading ownership.",a.error(n)})}}])}(),function(){"use strict";angular.module("organizationModule").service("CustomerService",["Restangular",function(e){var t=e.all("/user/customer");this.createTokenForRegisteredCustomer=function(e){return t.one(e+"").one("point_verification").customPOST()},this.validateCustomerEsewaId=function(e){return t.one("validate").customPOST(e)},this.validateCustomerTokenForRegisterdCustomer=function(e){return t.one(e.esewa_id+"").one("validate/registeredCustomer").one(e.token+"").customGET()},this.validateCustomerToken=function(e){return t.one(e.esewa_id+"").one("validate").one(e.token+"").customGET()},this.registerCustomer=function(e){return t.one(e.esewa_id+"").one("register").customPOST()},this.createCustomer=function(e){return t.one("create").customPOST(e)},this.saveFirstKyc=function(e){return t.one(e.esewa_id+"").one("kyc/first_phase").customPOST(e)},this.submitCustomerVerificationRequest=function(e){return t.one("/user/customer"+e+"/kyc/verification").one("kyc").one("verification").customPUT()},this.getCustomerList=function(){return e.all("customer").getList()},this.getCustomerToUpdate=function(e){return t.one(e+"").one("update_kyc").get()},this.getKycForCustomer=function(e){return t.one(e+"").one("kyc").get()},this.getMyCustomersList=function(){return t.one("my_customer").get()},this.getCustomerKycStatusList=function(){return t.one("status").getList()},this.getOccupationlist=function(){return t.one("getOccupation").getList()},this.validateUserInCas=function(e){return t.one(e+"").one("cas_validate").get()},this.checkToGenerateToken=function(e){return t.one(e+"").one("/validate/parent").get()}}])}(),function(){"use strict";angular.module("organizationModule").controller("UploadKycController",["$scope","$rootScope","$modalInstance","kyc","$state","occupationList","OrganizationStateConstant","CustomerKycUploadService","otherKycInformation","CDNUrl","$stateParams",function(e,t,n,o,a,i,r,s,c,l,u){e.kyc=o,e.occupationList=i,e.otherKycInformation=c,e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},t.closeModel=function(){e.close()},e.wantToProceedWithVerification=function(){e.close(),a.go(r.UPDATE_CUSTOMER_KYC,{userId:e.kyc.esewa_id})},e.getImageSrc=function(e){return e||l.defaultAccountUrl},e.uploadCustomerKyc=function(n){e.showloadingBar=!0;var o="/api/web/user/customer/"+e.kyc.eSewaId+"/kyc",a=[];a.push(n.document.profilePhoto),a.push(n.document.citizenship),n.document.otherId=n.document.otherId||{},n.document.otherId.name&&a.push(n.document.otherId),s.addOrUpdateCutomerKyc(o,"POST",n,a,u.userId).then(function(){delete t.address,delete t.temporaryAddress,delete t.fetchedTemporaryVdcs,delete t.fetchedTemporaryDistricts,delete t.fetchedVdcs,delete t.fetchedDistricts,delete t.fetchedDistrictsForDocuments,delete t.showCurrentToles,delete t.showCurrentWardNumber,delete t.showDistrict,delete t.showOtherCurrentAddress},function(){t.showloadingBar=!1})}}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerController",["$scope","$modal","$state","OrganizationStateConstant","CustomerService","$rootScope","$stateParams",function(e,t,n,o,a,i,r){function s(){e.customerRegistration={esewa_id:""}}i.errorMessage="",i.clearMessage(),s(),console.log(r),e.clearCustomerRegistrationForm=function(){s()},e.cancel=function(){n.go(o.HOME)},e.submitCustomerRegistration=function(t){i.errorMessage="",i.clearMessage(),a.validateCustomerEsewaId(t).then(function(n){e.disableSubmit=!1,e.response=n.plain(),angular.isDefined(e.response)&&null!==e.response&&("APPROVED"!==e.response.kyc_status&&null!==e.response.esewa_id?"SUBMIT_VERIFICATION_REQUEST"===e.response.kyc_status&&null!==e.response.esewa_id?i.successMessage="Verification request has already been sent!!!":e.confirmCustomerVerificationConfirmationDialog(e.response):"APPROVED"===e.response.kyc_status&&null!==e.response.esewa_id?i.successMessage="User is verified!!!":e.confirmCustomerCreation(t))},function(t){e.disableSubmit=!1,angular.isDefined(t)?i.errorMessage=t.data.error_message||t.data.message:i.errorMessage="Error while submiting form."})},e.confirmCustomerCreation=function(e){t.open({templateUrl:"/shared/customers/views/customer_creation_confirmation.html",controller:c,size:"md",backdrop:"static",resolve:{customerRegistration:function(){return e}}})};var c=["$scope","$modalInstance","customerRegistration","$state","CustomerService","OrganizationStateConstant","$timeout",function(e,t,n,o,a,r,s){e.customerRegistration=n,e.close=function(){t.dismiss()},e.cancel=function(){e.close()},e.wantToProceedWithRegistration=function(){a.registerCustomer(e.customerRegistration).then(function(t){e.response=t.plain(),e.close(),o.go(r.CUSTOMER_TOKEN_VALIDATION,{userId:n.esewa_id}),s(function(){i.successMessage=e.response.message},100),console.log(e.response)},function(t){e.close(),angular.isDefined(t)?i.errorMessage=t.data.error_message||t.data.message:i.errorMessage="Error while submiting form."})}}];e.confirmCustomerVerificationConfirmationDialog=function(e){t.open({templateUrl:"/shared/customers/views/customer_verification_confirmation.html",controller:l,size:"md custom-modal",backdrop:"static",resolve:{customVerificationResponse:function(){return e}}})};var l=["$scope","$modalInstance","customVerificationResponse","$state","OrganizationStateConstant",function(e,t,n,o,a){e.customVerificationResponse=n,e.close=function(){t.dismiss()},e.cancel=function(){e.close()},e.wantToProceedWithVerification=function(){e.close(),e.disableSubmit=!1,o.go(a.REGISTERED_CUSTOMER_TOKEN_VALIDATION,{userId:n.esewa_id})}}]}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerDetailController",["$scope","$rootScope","$http","NgTableParams",function(e,t,n,o){t.clearMessage(),e.customerList=new o({page:1,count:20},{total:0,getData:function(t,o){return n({method:"GET",url:"api/web/user/customer/my_customer",params:{page:o.page()-1,size:o.count()}}).then(function(t){var n=t.data;return e.customerList.total(n.totalElements),n.content})}})}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerRegistrationController",["$scope","$rootScope","$state","$modal","$stateParams","CustomerService","OrganizationStateConstant","ecmsg",function(e,t,n,o,a,i,r,s){t.errorMessage="",t.clearMessage(),e.showloadingBar=!1,e.customDetailDto={name:"",esewa_id:a.userId,gender:""},e.tokenValidationDto={esewa_id:a.userId,first_name:a.first_name},e.tokenValidationDto={esewa_id:a.userId,token:""},e.genders=["MALE","FEMALE","Other"],e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-5),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},e.showTokenValidation=!1,e.createCustomer=function(){return e.createCustomerDto={password:"",token:e.token,esewa_id:a.userId,organization_id:"",termsAndCondition:!0},i.createCustomer(e.createCustomerDto)},e.saveFirstKyc=function(o,s){2===o.split(" ").length?e.saveCustomerKycDto={first_name:o.split(" ").slice(0,-1).join(" "),last_name:o.split(" ").slice(-1).join(" "),esewa_id:a.userId,sex:s}:3===o.split(" ").length?e.saveCustomerKycDto={first_name:o.split(" ").slice(0,-2).join(" "),middle_name:o.split(" ").slice(1,-1).join(" "),last_name:o.split(" ").slice(-1).join(" "),esewa_id:a.userId,sex:s}:t.errorMessage="Invalid name",i.saveFirstKyc(e.saveCustomerKycDto).then(function(t){e.saveKycResponse=t.plain(),n.go(r.CUSTOMER_KYC_FORM,{userId:a.userId})},function(e){angular.isDefined(e)?t.errorMessage=e.data.message:t.errorMessage="Error while saving kyc."})},e.submitCustomerTokenValidation=function(o,c){e.token=o.token,e.full_name=o.full_name,e.gender=c,i.validateCustomerToken(o).then(function(o){e.showloadingBar=!1,e.respone=o,e.showTokenValidation=!0,e.createCustomer().then(function(t){e.createCustomerResponse=t.plain(),console.log(e.createCustomerResponse),e.saveFirstKyc(e.full_name,e.gender),n.go(r.CUSTOMER_KYC_FORM,{userId:a.userId})},function(e){angular.isDefined(e)?t.errorMessage=e.data.message:t.errorMessage="Error while submiting form."})},function(n){e.showloadingBar=!1,angular.isDefined(n)?s.error(n.data.message||n.data.error_message):t.errorMessage="Error while submitting form."})},angular.isUndefined(e.token)&&null===e.token&&n.go(r.CUSTOMER_REGISTRATION)}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerKycUpdateController",["$scope","$rootScope","$modal","$stateParams","CustomerService","OrganizationStateConstant","$state","OrgAddressService","$timeout","CDNUrl","ecmsg","BankService","$q","$http","ValidationService",function(e,t,n,o,a,i,r,s,c,l,u,d,m,g,f){t.clearMessage(),e.genders=["Male","Female","Other"],e.imageType=["Citizenship","License","Passport","Voter Id"];var p={};e.disableDocumentForm=!0,e.bankInfo={},e.fetchedZones={},e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},e.userName=o.userId,e.hideBankSelect=!1,e.document={},e.doc={otherId:{}};new FormData;e.confirmCustomerKyc=function(n,a,i){e.kyc={eSewaId:o.userId,customerkyc:JSON.parse(angular.toJson(n.customerKycForm)),address:a,temporaryAddress:i,documents:e.files,dateOfBirth:e.dateRange.fromDate,passportPreview:document.profilePhoto.src,citizenPreview:document.citizenship.src,otherIdPreview:document.otherId.src};var r={};e.kyc.customerkyc.date_of_birth_ad=e.customerkyc.date_of_birth_ad,e.kyc.customerkyc.date_of_birth_bs=e.customerkyc.date_of_birth_bs,e.kyc.customerkyc.identity_issued_date=e.customerkyc.identity_issued_date_ad,e.kyc.customerkyc.identity_issued_address_id=e.customerkyc.selectedDocumentIssuedDistrict,e.kyc.customerkyc.identity_number=e.customerkyc.documentNumber,angular.isDefined(e.bankInfo.selectedBank)&&""!==e.bankInfo.account_number&&(e.kyc.customerkyc.account_number=e.bankInfo.account_number,e.kyc.customerkyc.bank_code=e.bankInfo.selectedBank.swift_code,angular.isDefined(e.bankInfo.selectedBank.bank_display_name)?r.bankName=e.bankInfo.selectedBank.bank_display_name:r.bankName=e.bankInfo.selectedBank),r.temporaryVdc=_.find(t.fetchedTemporaryVdcs,{id:i.selectedVdc}).value,r.permanentVdc=_.find(t.fetchedVdcs,{id:a.selectedVdc}).value,e.kyc.customerkyc.filetype=e.customerkyc.imageType,"License"===e.customerkyc.imageType?e.fetchedZones.forEach(function(t){t.id===e.customerkyc.selectedDocumentIssuedDistrict&&(r.documentIssuedPlace=t.value)}):e.fetchedDistrictsForDocuments.forEach(function(t){t.id===e.customerkyc.selectedDocumentIssuedDistrict&&(r.documentIssuedPlace=t.value)}),console.log(r.documentIssuedPlace),e.customerVerificationConfirmationDialog(e.kyc,D,r)},e.customerVerificationConfirmationDialog=function(e,t,o){n.open({templateUrl:"/shared/customers/views/customer_kyc_confirmation.html",controller:h,size:"lg",backdrop:"static",resolve:{kyc:function(){return e},occupationList:function(){return t},otherKycInformation:function(){return o}}})};var h=["$scope","$rootScope","$modalInstance","kyc","occupationList","otherKycInformation","$state","OrganizationStateConstant","CustomerKycUploadService",function(e,t,n,a,i,r,s,c,l){console.log("initiating update"),e.occupationList=i,e.otherKycInformation=r,e.kyc=a,e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},t.closeModel=function(){e.close()},e.wantToProceedWithVerification=function(){e.close(),s.go(c.CUSTOMER_VERIFICATION,{userId:e.kyc.esewa_id})},e.uploadCustomerKyc=function(t){e.showloadingBar=!0;var n="/api/web/user/customer/"+e.kyc.eSewaId+"/kyc_update";l.addOrUpdateCutomerKyc(n,"POST",t,t.documents,o.userId).then(function(){})}}];function w(){a.getCustomerToUpdate(o.userId).then(function(n){if(e.customerDetail=n.plain(),e.getZoneOrProvince(),angular.isDefined(e.customerDetail.date_of_birth_ad)&&(e.customerDetail.date_of_birth_ad=new Date(e.customerDetail.date_of_birth_ad)),angular.isDefined(e.customerDetail.identity_issued_date))if(e.customerDetail.identity_issued_date){var a=new Date(e.customerDetail.identity_issued_date);e.customerDetail.identity_issued_date_ad=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}else e.customerDetail.identity_issued_date_ad="";angular.forEach(e.customerDetail.identification_resource,function(t){e.downloadOrgDocument(o.userId,t.identification).then(function(e){t.file=e.data.file})}),e.setCustomerForm(e.customerDetail),null!==e.customerDetail.account_number&&""!==e.customerDetail.account_number&&(e.hideBankSelect=!0),c(function(){e.getPermanentAddress(e.customerDetail.permanent_address),e.address.selectedVdc=n.permanent_address.vdc_municipality_id,_.forEach(e.customerDetail.identification_resource,function(t){"IMAGE"===t.document_type?(e.imageId=t.identification,e.document.profilePhoto=t):(e.ctznId=t.identification,angular.isDefined(e.document.citizenship)?e.document.otherId=t:e.document.citizenship=t)}),e.retrivedTempAddress=e.customerDetail.current_address,e.getTemporaryAddress(e.customerDetail.current_address),e.temporaryAddress.tole=e.retrivedTempAddress.tole,s.getNewDistricts(e.retrivedTempAddress.zone_id).then(function(n){t.fetchedTemporaryDistricts=n.plain(),s.getVdcs(e.retrivedTempAddress.district_id).then(function(n){t.fetchedTemporaryVdcs=n.plain(),e.temporaryAddress.selectedVdc=e.retrivedTempAddress.vdc_municipality_id,e.temporaryAddress.wardNumber=parseInt(e.retrivedTempAddress.ward_number)})})},500),e.$broadcast("customerDetailLoadFinish","")},function(e){!function(e){angular.isDefined(e)?u.error(e.data.message||e.data.error_message):u.error("Error while submitting verification request."),r.go(i.CUSTOMER_REGISTRATION)}(e)})}e.submitVerificationRequest=function(){a.submitCustomerVerificationRequest(o.userId).then(function(t){e.response=t.plain(),r.go(i.CUSTOMERS_LIST)},function(e){angular.isDefined(e)?t.errorMessage=e:t.errorMessage="Error while submitting verification request."})},e.getZoneOrProvince=function(){e.customerDetail.newAddress?s.getProvince().then(function(t){e.fetchedZones=t.plain(),p=e.fetchedZones}):s.getZones().then(function(t){e.fetchedOldZones=t.plain(),p=e.fetchedOldZones})},e.getPermanentAddress=function(n){function o(){s.getNewDistricts(e.zone.id).then(function(e){t.fetchedDistricts=e.plain()}),s.getDistrict(n.district_id).then(function(o){e.fetchedDistrict=o.plain(),t.address.selectedDistrict=e.fetchedDistrict,s.getVdcs(e.fetchedDistrict.id).then(function(e){t.fetchedVdcs=e.plain(),t.fetchedVdcs=e.plain()}),c(function(){s.getVdc(n.district_id,n.vdc_municipality_id).then(function(n){e.fetchedVdc=n.plain(),t.address.selectedVdc=e.fetchedVdc.vdc_municipality_id})},10)})}_.forEach(p,function(a){a.id===n.zone_id&&(e.zone=a,t.address.selectedZone=e.zone,o())}),t.address.tole=n.tole,t.address.wardNumber=parseInt(n.ward_number)},e.getTemporaryAddress=function(n){_.forEach(p,function(o){o.id===n.zone_id&&(e.zone=o,t.temporaryAddress.selectedZone=e.zone)}),t.temporaryAddress.selectedDistrict="",s.getDistrict(n.district_id).then(function(o){e.fetchedDistrict=o.plain(),t.temporaryAddress.selectedDistrict=e.fetchedDistrict,c(function(){s.getVdcs(n.district_id).then(function(t){e.temporaryFetchedVdcs=t.plain()}),s.getVdc(n.district_id,n.vdc_municipality_id).then(function(n){e.fetchedVdc=n.plain(),t.temporaryAddress.selectedVdc=e.fetchedVdc.vdc_municipality_id})},100)}),t.temporaryAddress.selectedVdc="",t.temporaryAddress.tole=n.tole,t.temporaryAddress.wardNumber=1*n.ward_number},e.setCustomerForm=function(t){var n,o;e.customerkyc={name:null===t.first_name?"":""!==t.middle_name?t.first_name+" "+t.middle_name+" "+t.last_name:t.first_name+" "+t.last_name,fatherName:t.father_name,grandFatherName:t.grand_father_name,identificationNumber:t.identity_number,selectedDocumentIssuedDistrict:t.identity_issued_address_id,occupation:t.occupation_id,gender:null===t.sex?"":"M"===t.sex?"Male":"F"===t.sex?"Female":"Other",landlineNumber:t.land_line_number,spouseName:t.spouse_name,date_of_birth_bs:t.date_of_birth_bs,identity_issued_date_ad:t.identity_issued_date_ad,panNumber:t.pan_number,documentNumber:t.identity_number,imageType:function(){if(angular.isDefined(t.identification_resource)&&null!==t.identification_resource&&t.identification_resource.length>1)switch(t.identification_resource[1].document_type){case"CTZN":return"Citizenship";case"LICENSE":return"License";case"PASSPORT":return"Passport";case"VOTERID":return"Voter Id";default:return"Citizenship"}return""}(),remarks:t.remarks},e.bankInfo={account_number:t.account_number},(n=t.bank_code,o=m.defer(),angular.forEach(e.bankList,function(e){e.swift_code===n&&o.resolve(e.bank_display_name)}),o.promise).then(function(t){e.bankInfo.selectedBank=t}),e.documentIssuedPlace={selectedDocumentIssuedDistrict:t.identity_issued_address_id},e.dateRange.fromDate=angular.isDefined(t.date_of_birth_ad)?new Date(t.date_of_birth_ad):null},e.downloadOrgDocument=function(e,t){return g({method:"GET",url:"/api/web/user/customer/"+e+"/kyc/document/download/"+t,headers:{"Content-Type":void 0}})};var D=[];e.getOccupationList=function(){a.getOccupationlist().then(function(t){for(var n in e.occupationList=t.plain(),e.occupationList)D[e.occupationList[n].id]=e.occupationList[n].occupation_name})},e.uploadNewFile=function(t){e.currentEditingDocType=t,e.formDataDoc="",$("#"+t+"_in").click()},e.checkDate=function(){console.log(e.month+" "+e.day)},e.editDocuments=function(){n.open({templateUrl:"customers/views/customer_document_update.html",controller:v,size:"lg"})};var v=["$scope","$rootScope","$modalInstance",function(e,t,n){e.close=function(){n.dismiss()},t.currentModal=n,e.cancel=function(){e.close()},e.wantToProceedWithVerification=function(){e.close(),r.go(i.CUSTOMER_VERIFICATION,{userId:e.kyc.esewa_id})}}];e.getImageSrc=function(e){return e||l.defaultAccountUrl};var y=["$scope","doc","image_src","$modalInstance",function(e,n,o,a){e.doc=n,e.image_src=o,e.cancel=function(){a.dismiss()},t.currentModal=a}];e.showImageInPopup=function(e){n.open({templateUrl:"/shared/views/model_image.html",size:"xl",controller:y,resolve:{image_src:function(){var t=document.querySelector("#"+e.document_type+"_"+e.identification);return _.isElement(t)?t.src:document.querySelector("."+e).src},doc:function(){return e}}})},e.getDocumentStatusName=function(e){switch(e){case"REJECTED":return"Rejected";case"ACCEPTED":case"APPROVED":return"Approved";case"SUBMIT_VERIFICATION_REQUEST":return"Verification Request Submitted";case"CANCEL_VERIFICATION_REQUEST":return"Verification Request Cancelled";case"PENDING":return"Pending";default:return""}},e.getIconForStatus=function(e){switch(e){case"REJECTED":return"/images/kyc_rejected.png";case"ACCEPTED":case"APPROVED":return"/images/kyc_approved.png";default:return"/images/kyc_pending.png"}},e.uploadNew=function(e){"",$("#"+e+"_in").click()};var I=function(){e.otherDocForm.otherFile.$modelValue={},e.otherDocForm.otherFile.$viewValue={},e.otherDocForm.otherFile.$lastCommittedViewValue={},document.otherId.src="",angular.element("."+e.currentEditingDocType).attr("src","")};function S(e){return e.file[0].size<=10485760&&e.file[0].size>10}e.files=[],e.addNewDocument=function(t,n,o){if(!(t.length<1)){new FormData,o=o.replace("_in","");var a=document.getElementsByClassName(o)[0].getAttribute("id"),i=Array.isArray(a.match(/\d+/))?a.match(/\d+/)[0]:"",r=Array.isArray(a.match(/[A-Z]+/))?a.match(/[A-Z]+/)[0]:"";e.fileDto={file:t,documentId:i,fileType:r,documentType:o},_.remove(e.files,[{documentId:e.fileDto.documentId},{fileType:r}]),_.remove(e.files,{documentType:o}),e.fileDto.file&&e.files.push(e.fileDto);var s=new FileReader;s.onload=function(e){angular.element("."+o).attr("src",e.target.result),angular.element("#btn"+o).removeClass("hide")},s.readAsDataURL(n.files[0]),e.$broadcast("addNewFileInTempArrayFinish",e.files)}},e.cancel=function(){r.go(i.CUSTOMER_VERIFICATION_HISTORY)},e.checkDocumentValidity=function(t){var n=!1;switch(t){case"otherId":n=document.otherId.src.split("/").pop().split(".").pop()===/\.(jpeg|jpg|png)$/||"account_picture"!==document.otherId.src.split("/").pop(),e.otherDocForm.otherFile.$error=n?{}:{required:!0};break;case"profilePhoto":(n=document.profilePhoto.src.split("/").pop().split(".").pop()===/\.(jpeg|jpg|png)$/||"account_picture"!==document.profilePhoto.src.split("/").pop())?(e.profileDocForm.profilePhoto.$error={},e.profileDocForm.profilePhoto.$invalid=!1,e.profileDocForm.$invalid=!1,e.profileDocForm.$error={},e.profileDocForm.$$parentForm.$invalid=!1,e.profileDocForm.$$parentForm.$error={}):e.profileDocForm.profilePhoto.$error={required:!0};break;case"citizenship":(n=document.citizenship.src.split("/").pop().split(".").pop()===/\.(jpeg|jpg|png)$/||"account_picture"!==document.citizenship.src.split("/").pop())?(e.ctznDocForm.citizenship.$error={},e.ctznDocForm.citizenship.$invalid=!1,e.ctznDocForm.$invalid=!1,e.ctznDocForm.$error={},e.ctznDocForm.$$parentForm.$error={},e.ctznDocForm.$$parentForm.$invalid=!1):e.ctznDocForm.citizenship.$error={required:!0}}e.$$phase||e.$apply()},e.hasNewfileInTemp=function(t){return!!_.find(e.files,t)},e.setDocumentIssuedPlace=function(){e.customerkyc.selectedDocumentIssuedDistrict=""},e.$on("customerDetailLoadFinish",function(){c(function(){e.checkDocumentValidity("otherId"),e.checkDocumentValidity("profilePhoto"),e.checkDocumentValidity("citizenship")},100)}),e.$on("addNewFileInTempArrayFinish",function(t,n){var o,a;o=n,a="",_.forEach(o,function(t){switch(t.file[0].type.match("image/")||(a="Selected file is not an image"),e.currentEditingDocType||t.fileType){case"IMAGE":case"profilePhoto":S(t)?(e.profileDocForm.profilePhoto.$setValidity("size",!0),e.profileDocForm.profilePhoto.$invalid=!1,e.profileDocForm.profilePhoto.$error={},e.profileDocForm.profilePhoto.$valid=!0,e.photoMsg=a):(e.profileDocForm.profilePhoto.$setValidity("size",!1),e.photoMsg="File size is not valid");break;case"CTZN":case"citizenship":S(t)?(e.ctznDocForm.citizenship.$setValidity("size",!0),e.ctznDocForm.citizenship.$invalid=!1,e.ctznDocForm.citizenship.$error={},e.ctznDocForm.citizenship.$valid=!0,e.ctznMsg=a):(e.ctznDocForm.citizenship.$setValidity("size",!1),e.ctznMsg="File size is not valid");break;case"otherId":S(t)?(e.otherDocForm.otherFile.$setValidity("size",!0),e.checkDocumentValidity("otherId"),e.otherMsg=a):(e.otherDocForm.otherFile.$setValidity("size",!1),e.otherMsg="File size is not valid",c(I(),500))}e.$$phase||e.$apply()})}),angular.element(document).ready(function(){w()}),e.resetForm=function(){e.customerkyc={},e.address={},e.customerAddressForm.$setPristine(),e.customerKycForm.$setPristine()},e.cancelCustomerKyc=function(){r.go(i.CUSTOMER_REGISTRATION)},d.getBankListForWithdraw().then(function(t){e.bankList=t.plain()},function(e){angular.isDefined(e)?t.message.error=e.data.message:t.message.error="Error while fetching data."}),e.checkDateValidation=function(e,t){return!t&&!f.checkDOBValid(e)}}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerVerificationDetailController",["$scope","$rootScope","CustomerService","OrganizationStateConstant","$state","$modal","NgTableParams","$http","DateFormatter",function(e,t,n,o,a,i,r,s,c){t.clearMessage(),e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-5),this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},e.selectedStatus="",e.reloadTable=function(){t.errorMessage="",e.customerTable.reload()},e.customerTable=new r({page:1,count:25},{total:0,getData:function(t,n){return e.showLoadingBar=!0,s({method:"GET",url:"api/web/user/customer",params:{status:""===e.selectedStatus?"":e.selectedStatus,esewa_id:angular.isUndefined(e.esewaId)?"":e.esewaId,to_date:c.formatDate(e.dateRange.toDate.toISOString()),from_date:c.formatDate(e.dateRange.fromDate.toISOString()),page:n.page()-1,size:n.count()}}).then(function(t){var n=t.data;return e.customerTable.total(n.totalElements),n.content}).finally(function(){e.showLoadingBar=!1})}}),e.editKyc=function(e){console.log(e),a.go(o.UPDATE_CUSTOMER_KYC,{userId:e,edit:!0})},e.showCustomerKycDetailDialog=function(e){i.open({templateUrl:"/shared/customers/views/customer_kyc_detail.html",controller:l,size:"lg custom-modal",backdrop:"static",resolve:{eSewaId:function(){return e}}})};var l=["$scope","$rootScope","$modalInstance","eSewaId","$http",function(e,t,o,a,i){e.eSewaId=a,e.close=function(){o.dismiss()},t.currentModal=o,e.cancel=function(){e.close()},e.downloadDocument=function(e,t){return i({method:"GET",url:"/api/web/user/customer/"+e+"/kyc/document/download/"+t,headers:{"Content-Type":void 0}})},n.getKycForCustomer(a).then(function(t){e.customerKycDetail=t.plain(),angular.forEach(e.customerKycDetail.identification_resource,function(t){e.downloadDocument(a,t.identification).then(function(e){t.file=e.data.file})})},function(e){angular.isDefined(e)?t.errorMessage=e:t.errorMessage="Error while fetching customer kyc."})}];n.getCustomerKycStatusList().then(function(t){e.kycStatusList=t.plain().filter(function(e){return"NO_DATA"!==e&&"APPROVED"!==e&&"CANCEL_VERIFICATION_REQUEST"!==e})},function(e){angular.isDefined(e)?t.errorMessage=e:t.errorMessage="Error while fetching customer kyc status."})}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerTokenVerificationController",["$scope","$rootScope","$state","$modal","$stateParams","CustomerService","OrganizationStateConstant","ecmsg",function(e,t,n,o,a,i,r,s){t.errorMessage="",e.showloadingBar=!1,t.clearMessage(),e.tokenValidationDto={esewa_id:a.userId,token:""},e.showTokenValidation=!1,e.generateToken=function(){i.checkToGenerateToken(a.userId).then(function(){n.go(r.UPDATE_CUSTOMER_KYC,{userId:a.userId})},function(){i.createTokenForRegisteredCustomer(a.userId).then(function(t){e.createCustomerResponse=t.plain()},function(e){angular.isDefined(e)?s.error(e.data.message||e.data.error_message):s.error("Error while submiting form."),n.go(r.CUSTOMER_REGISTRATION)})})},e.generateToken(),e.submitCustomerTokenValidation=function(o){e.token=o.token,i.validateCustomerTokenForRegisterdCustomer(o).then(function(t){e.showloadingBar=!1,e.respone=t,e.showTokenValidation=!0,n.go(r.UPDATE_CUSTOMER_KYC,{userId:o.esewa_id})},function(n){e.showloadingBar=!1,angular.isDefined(n)?s.error(n.data.message||n.data.error_message):t.errorMessage="Error while submitting form."})},angular.isUndefined(e.token)&&null===e.token&&n.go(r.CUSTOMER_REGISTRATION)}])}(),function(){"use strict";angular.module("organizationModule").controller("CustomerKycController",["$scope","$rootScope","$modal","$stateParams","CustomerService","OrganizationStateConstant","$state","$timeout","$http","OrgAddressService","CDNUrl","RegexConstant","ecmsg","BankService","FirstLoadCommissionService","$localStorage","ValidationService",function(e,t,n,o,a,i,r,s,c,l,u,d,m,g,f,p,h){e.tole=d.tole,t.clearMessage(),e.customerKycForm={},e.customerkyc={},e.bankInfo={},e.genders=["Male","Female","Other"],e.imageType=["Citizenship","License","Passport","Voter Id"],e.firstLoadCommissionAmount=0;var w=[];e.documentPath={},e.getOccupationList=function(){a.getOccupationlist().then(function(t){for(var n in e.occupationList=t.plain(),e.occupationList)w[e.occupationList[n].id]=e.occupationList[n].occupation_name})},e.document={profilePhoto:{},otherId:{},citizenship:{}},e.IdentificationNo={profilePhotoIdentityNo:"",otherIdIdentityNo:"",citizenshipIdentityNo:""};var D=1;function v(){var t=p.user.isCashIn?"FIRST_CASHIN":"FIRST_SEND_MONEY";f.getFirstLoadCommission(t,o.userId).then(function(t){e.firstLoadCommissionAmount=t,n.open({templateUrl:"/shared/customers/views/first_load_commission_modal.html",controller:"FirstLoadCommissionController",size:"md",backdrop:"static",scope:e})},function(){r.go(i.CUSTOMER_REGISTRATION)})}e.downloadOrgDocument=function(e,t){return c({method:"GET",url:"/api/web/user/customer/"+e+"/kyc/document/download/"+t,headers:{"Content-Type":void 0}})},e.getImageSrc=function(e){return e||"https://cdn.esewa.com.np/ui/images/icons/placeholder.png"},e.formDataDoc=new FormData,e.uploadNewFile=function(t){e.formDataDoc="",$("#"+t+"_in").click()},e.addNewDocument=function(t,n,o){e.formDataDoc=[],o=o.replace("_in",""),e.formDataDoc.push(t[0]),"profilePhoto"===o?(e.document.profilePhoto=t[0],angular.isDefined(e.profileDocForm.$$parentForm.profilePhoto)&&(e.profileDocForm.$$parentForm.profilePhoto.$error={}),e.profileDocForm.profilePhoto.$invalid=!1,e.profileDocForm.profilePhoto.$valid=!0,e.kycForm.profileDocForm.profilePhoto.$setValidity("required",!1)):"citizenship"===o?(e.document.citizenship=t[0],angular.isDefined(e.profileDocForm.$$parentForm.citizenship)&&(e.ctznDocForm.$$parentForm.citizenship.$error={}),e.ctznDocForm.citizenship.$invalid=!1,e.ctznDocForm.citizenship.$valid=!0,e.kycForm.ctznDocForm.citizenship.$error={},e.kycForm.ctznDocForm.citizenship.$setValidity("required",!1)):e.document.otherId=t[0];var a=new FileReader;a.onload=function(t){angular.element("."+o).attr("src",t.target.result),"profilePhoto"===o?e.documentPath.profilePhoto=t.target.result:"citizenship"===o?e.documentPath.citizenship=t.target.result:e.documentPath.otherId=t.target.result},a.readAsDataURL(n.files[0]),e.hidePhotoUpload=!1,e.$$phase||e.$apply()},a.getCustomerToUpdate(o.userId).then(function(t){if(e.customerDetail=t.plain(),angular.isDefined(e.customerDetail.date_of_birth_ad)&&(e.customerDetail.date_of_birth_ad=new Date(e.customerDetail.date_of_birth_ad)),angular.isDefined(e.customerDetail.identity_issued_date)){var n=new Date(e.customerDetail.identity_issued_date);e.customerDetail.identity_issued_date_ad=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()}e.setCustomerForm(e.customerDetail),angular.isDefined(e.customerDetail.permanent_address)&&angular.isDefined(e.customerDetail.current_address)&&e.customerDetail.permanent_address&&(e.getPermanentAddress(e.customerDetail.permanent_address),e.getTemporaryAddress(e.customerDetail.current_address)),_.forEach(e.customerDetail.identification_resource,function(t){e.downloadOrgDocument(o.userId,t.identification).then(function(e){t.file=e.data.file}),"IMAGE"===t.document_type?(e.document.profilePhoto=t,e.IdentificationNo.profilePhotoIdentityNo=t.identification):D>1?(e.document.otherId=t,e.IdentificationNo.otherIdIdentityNo=t.identification):(e.document.citizenship=t,e.IdentificationNo.citizenshipIdentityNo=t.identification,D++)})},function(e){!function(e){angular.isDefined(e)?m.error(e.data.message||e.data.error_message):m.error("Error while submitting verification request."),r.go(i.CUSTOMER_REGISTRATION)}(e)}),e.setCustomerForm=function(t){null!==t.first_name&&(e.customerkyc={name:""!==t.middle_name?t.first_name+" "+t.middle_name+" "+t.last_name:t.first_name+" "+t.last_name,fatherName:t.father_name,grandFatherName:t.grand_father_name,identificationNumber:t.identity_number,occupation:t.occupation_id,imageType:"",remarks:""},e.bankInfo={account_number:""},e.dateRange.toDate=new Date(t.identity_issued_date),e.customerkyc.gender="M"===t.sex?"Male":"F"===t.sex?"Female":"Other",e.dateRange.fromDate=new Date(t.date_of_birth_ad)),e.customerkyc.remarks=""},e.getPermanentAddress=function(n){l.getProvince().then(function(o){t.fetchedZones=o.plain(),_.forEach(e.fetchedZones,function(o){o.id===n.zone_id&&(e.zone=o,t.address.selectedZone=e.zone,l.getNewDistricts(e.zone.id).then(function(e){t.fetchedDistricts=e.plain()}),l.getNewDistrict(n.district_id).then(function(e){var o;t.address.selectedDistrict=e.plain(),o=e.id,l.getVdcs(o).then(function(e){t.fetchedVdcs=e.plain()}),s(function(){l.getVdc(n.district_id,n.vdc_municipality_id).then(function(e){t.address.selectedVdc=e.plain().vdc_municipality_id})},500)}))})}),t.address.tole=n.tole,t.address.wardNumber=1*n.ward_number},e.getTemporaryAddress=function(n){t.temporaryAddress.selectedZone=_.find(e.fetchedZones,{id:n.zone_id}).id,t.temporaryAddress.selectedDistrict={},l.getDistrict(n.district_id).then(function(e){t.temporaryAddress.selectedDistrict=e.plain(),s(function(){l.getVdcs(n.district_id).then(function(e){t.temporaryFetchedVdcs=e.plain()}),l.getVdc(n.district_id,n.vdc_municipality_id).then(function(e){t.temporaryAddress.selectedVdc=e.plain().vdc_municipality_id})},500)}),t.temporaryAddress.selectedVdc={},t.temporaryAddress.tole=n.tole,t.temporaryAddress.wardNumber=1*n.ward_number},e.resetForm=function(){e.customerkyc={},e.address={},e.customerAddressForm.$setPristine(),e.customerKycForm.$setPristine()},e.cancelCustomerKyc=function(){delete t.address,delete t.temporaryAddress,delete t.fetchedTemporaryVdcs,delete t.fetchedTemporaryDistricts,delete t.fetchedVdcs,delete t.fetchedDistricts,delete t.fetchedDistrictsForDocuments,delete t.showCurrentToles,delete t.showCurrentWardNumber,delete t.showDistrict,delete t.showOtherCurrentAddress,r.go(i.CUSTOMER_REGISTRATION)},e.dateRange=new function(){this.fromDate=new Date,this.fromDate.setHours(0,0,0,0),this.toDate=new Date,this.toDate.setHours(23,59,59,59)},e.userName=o.userId,e.confirmCustomerKyc=function(n,a,i,r){e.kyc={eSewaId:o.userId,customerkyc:JSON.parse(angular.toJson(n.customerKycForm)),address:a,temporaryAddress:i,document:r,dateOfBirth:e.dateRange.fromDate,profilePhotoIdentityNo:e.IdentificationNo.profilePhotoIdentityNo,otherIdIdentityNo:e.IdentificationNo.otherIdIdentityNo,citizenshipIdentityNo:e.IdentificationNo.citizenshipIdentityNo};var s={};e.kyc.customerkyc.date_of_birth_ad=e.customerkyc.date_of_birth_ad,e.kyc.customerkyc.date_of_birth_bs=e.customerkyc.date_of_birth_bs,e.kyc.customerkyc.identity_issued_date=e.customerkyc.identity_issued_date_ad,e.kyc.customerkyc.identity_issued_address_id=e.customerkyc.selectedDocumentIssuedDistrict,e.kyc.customerkyc.identity_number=e.customerkyc.documentNumber,angular.isDefined(e.bankInfo.selectedBank)&&""!==e.bankInfo.account_number&&(e.kyc.customerkyc.account_number=e.bankInfo.account_number,e.kyc.customerkyc.bank_code=e.bankInfo.selectedBank.swift_code,s.bankName=e.bankInfo.selectedBank.bank_display_name),e.kyc.customerkyc.filetype=e.customerkyc.imageType,"License"===e.customerkyc.imageType?e.fetchedZones.forEach(function(t){t.id===e.customerkyc.selectedDocumentIssuedDistrict&&(s.documentIssuedPlace=t.value)}):e.fetchedDistrictsForDocuments.forEach(function(t){t.id===e.customerkyc.selectedDocumentIssuedDistrict&&(s.documentIssuedPlace=t.value)}),s.temporaryVdc=_.find(t.fetchedTemporaryVdcs,{id:i.selectedVdc}).value,s.permanentVdc=_.find(t.fetchedVdcs,{id:a.selectedVdc}).value,e.customerVerificationConfirmationDialog(e.kyc,w,s)},s(function(){t.showloadingBar=!1},2e4),e.customerVerificationConfirmationDialog=function(t,o,a){n.open({templateUrl:"/shared/customers/views/customer_kyc_confirmation.html",controller:"UploadKycController",size:"lg custom-modal",backdrop:"static",scope:e,resolve:{kyc:function(){return t},occupationList:function(){return o},otherKycInformation:function(){return a}}})},s(function(){t.showloadingBar=!1},1e4),e.submitVerificationRequest=function(){a.submitCustomerVerificationRequest(o.userId).then(function(t){e.response=t.plain(),e.firstLoadCommissionAmount=e.response.first_load_commission_amount,v()},function(e){angular.isDefined(e)?t.errorMessage=e:t.errorMessage="Error while submitting verification request."})},e.cancelVerification=function(){v()},e.setDocumentIssuedPlace=function(){e.customerkyc.selectedDocumentIssuedDistrict=""},g.getBankListForWithdraw().then(function(t){e.bankList=t.plain()},function(e){angular.isDefined(e)?t.message.error=e.data.message:t.message.error="Error while fetching data."}),e.checkDateValidation=function(e,t){return!t&&!h.checkDOBValid(e)}}])}(),function(){"use strict";angular.module("organizationModule").controller("PointEsewaCashInController",["$scope","$state","PointEsewaMoneyTransferService","$rootScope","$modal","$timeout","PointCashInResponseDetail","StateConstant","AUTH_EVENTS","MerchantPaymentService","$sce","RegexConstant","ecmsg","$http","CDNUrl","$stateParams","NewTransactionDetail",function(e,t,n,o,a,i,r,s,c,l,u,d,m,g,f,p,h){e.confirmCashIn=!1,e.paymentRequest={amount:0,properties:{enquiry:"",receiverEsewaId:"",remarks:"",purpose:""},product_code:""},o.message={},e.usernameRegex=d.username,null!==o.message&&angular.isDefined(o.message)&&(o.message.error=""),e.loadCashinNumber=function(){i(function(){e.cashinNumber=p.cashinNumber,e.paymentRequest.receiver_name=p.cashinNumber},0)},e.reset=function(){e.paymentRequest={amount:0,properties:{enquiry:"",receiverEsewaId:"",remarks:"",purpose:""},product_code:""},e.loadCashinNumber()},e.validationfailed=!1,e.disableSubmit=!1,e.esewaCashInRequest={},e.goTocashIn=function(){t.go("main.cashin")},e.cashInResponse=r,(angular.isDefined(r.remarks)||""!==r.remarks)&&(e.paymentRequest.properties.remarks=r.remarks,e.paymentRequest.properties.purpose=r.purpose),e.getProductDetails=function(){l.getProductDetails("CASHIN").then(function(t){t?(e.productDetails=t.plain(),e.trustedPaymentDescription=u.trustAsHtml(e.productDetails.shortDescription)):e.productDetails={displayName:"Cash IN",name:"Cash IN"},g.get(f.url+"/data/cashinPurpose.json").then(function(t){e.cashInPurpose=t.data})},function(e){angular.isDefined(e)?o.message.error=e.data.error_message:o.message.error="Error while fetching product details."})};e.confirmCashInDetail=function(a){e.esewaCashInRequest.receiverUserName=a.receiver_name,e.esewaCashInRequest.amount=a.amount,e.esewaCashInRequest.remarks=a.remarks,n.getCashInValidationInfo(e.esewaCashInRequest).then(function(n){e.cashInResponse=n.plain(),function(e,t){r.amount=e.amount,r.properties=e.properties,r.additional_charge_amount=e.additional_charge_amount,r.first_load_cashin_commission=e.first_load_cashin_commission,r.charge_amount=e.charge_amount,r.esewa_id=e.esewa_id,r.full_name=e.full_name,r.remaining_daily_free_txn_amount=e.remaining_daily_free_txn_amount,r.remaining_daily_free_txn_count=e.remaining_daily_free_txn_count,r.request_unique_id=e.request_unique_id,r.response_code=e.response_code,r.response_message=e.response_message,r.transaction_entry_id=e.transaction_entry_id,r.cash_in_amount=e.cash_in_amount,r.remarks=t.remarks,r.purpose=t.purpose}(e.cashInResponse,a),e.confirmCashIn=!0,t.go("cashIn.confirm-detail")},function(e){o.message.error=e?angular.isDefined(e.data.error_message)?e.data.error_message:e.data.message:"Cash in validation failed"})},e.makePayment=function(a){e.disableSubmit=!0,e.paymentRequest.product_code="CASHIN",e.paymentRequest.amount=a.amount,e.paymentRequest.properties.receiverEsewaId=a.esewa_id,e.paymentRequest.unique_id=a.request_unique_id,e.paymentRequest.channel="WEB_USER",n.makeCashInPayment(e.paymentRequest).then(function(n){h.properties=n.properties,t.go(s.TRANSACTIONS,{txnId:n.transaction_code,moduleId:n.module_id}),o.$broadcast(c.getBalanceAndRewards),e.disableSubmit=!1},function(t){t?m.error(t.data.error_message||t.data.message):m.error("Cash in failed"),e.disableSubmit=!1})}}])}(),function(){"use strict";angular.module("organizationModule").service("PointEsewaMoneyTransferService",["Restangular",function(e){var t=e.all("auth");this.validateMoneyTransfer=function(){return t.one("validate").one("money-transfer").get()},this.getCashInValidationInfo=function(e){return t.one("validate").one("cash_in").get({amount:e.amount,remarks:e.remarks,receiver_name:e.receiverUserName})},this.makeCashInPayment=function(e){return t.one("cash_in").one("transfer").customPOST(e)}}])}(),function(){"use strict";angular.module("organizationModule").factory("PointCashInResponseDetail",function(){return{amount:void 0,properties:void 0,additional_charge_amount:void 0,charge_amount:void 0,esewa_id:void 0,full_name:void 0,ramaining_daily_free_txn_amount:void 0,ramaining_daily_free_txn_count:void 0,request_unique_id:void 0,response_code:void 0,response_message:void 0,transaction_entry_id:void 0,cash_in_amount:void 0,remarks:void 0,isDefined:function(){}}})}(),function(){"use strict";angular.module("organizationModule").controller("BulkTopupController",["$scope","$rootScope","$http","NgTableParams","$stateParams","ecmsg","$state","AUTH_EVENTS","$modal","$timeout","CDNUrl",function(e,t,n,o,a,i,r,s,c,l,u){e.productCode=angular.isDefined(a.productCode)?a.productCode:"",e.excelTable=new o({page:1,count:25},{counts:[],getData:function(e,t){return n({method:"GET",url:"/api/web/auth/bulk_payment/excel",params:{page:t.page()-1,size:t.count()}}).then(function(e){return t.total(e.data.totalElements),e.data.content})}}),e.batchId=a.batchId,e.topupTable=new o({page:1,count:25},{counts:[],getData:function(t,o){return n({method:"GET",url:"/api/web/auth/bulk_payment/excel/"+e.batchId,params:{page:o.page()-1,size:o.count(),mobileNumber:e.mobileNumber,status:e.status,product:e.product}}).then(function(e){return o.total(e.data.totalElements),e.data.content})}}),e.reloadableExcelTable=function(){e.excelTable.page(1),e.excelTable.total(0),e.excelTable.reload()},e.reloadableTopupTable=function(t,n,o){e.mobileNumber=t,e.status=n,e.product=o,e.topupTable.page(1),e.topupTable.total(0),e.topupTable.reload()},e.resetTopupTable=function(){e.mobileNumber="",e.status="",e.product="",e.reloadableTopupTable()},e.excel=new FormData,e.uploadFileToServer=function(t){e.excel=new FormData,e.excel.append("topupExcelFile",t[0])},e.showloadingBar=!1,e.uploadFile=function(){if(0===e.excel.length)return!1;e.showloadingBar=!0,n({method:"POST",url:"/api/web/auth/bulk_payment/excel?productCode="+e.productCode,data:e.excel,headers:{"Content-type":void 0}}).success(function(t){e.message="File Uploaded Successfully.",l(function(){e.showloadingBar=!1,i.info(t.message),r.go("batch.bulkUploadList")},2e3)}).error(function(t){e.showloadingBar=!1,i.error(t.error_message)})},e.proceedBatchTopup=function(o){e.showloadingBar=!0,n({method:"POST",url:"/api/web/auth/bulk_payment/excel/"+o+"/process",data:{},headers:{"Content-type":void 0}}).success(function(n){l(function(){e.showloadingBar=!1,i.info(n.message),e.reloadableExcelTable(),t.$broadcast(s.getBalanceAndRewards)},2e3)}).error(function(t){e.showloadingBar=!1,i.error(t.error_message),e.reloadableExcelTable()})},e.cancelBatchTopup=function(t){e.showloadingBar=!0,n({method:"POST",url:"/api/web/auth/bulk_payment/excel/"+t+"/cancel",data:{},headers:{"Content-type":void 0}}).success(function(t){e.showloadingBar=!1,i.info(t.message),r.go("batch.bulkUploadList")}).error(function(t){e.showloadingBar=!1,i.error(t.error_message),e.reloadableExcelTable()})},e.getBatchDetails=function(t){if(0===e.excel.length)return!1;e.showloadingBar=!0,n({method:"GET",url:"/api/web/auth/bulk_payment/excel/"+t+"/details",data:e.excel,headers:{"Content-type":void 0}}).success(function(t){e.showloadingBar=!1,e.batchDetails=t}).error(function(t){e.showloadingBar=!1,i.error(t.error_message)})},e.cancelTopup=function(o){e.showloadingBar=!0,n({method:"POST",url:"/api/web/auth/bulk_payment/excel/payment/"+o+"/cancel",data:{},headers:{"Content-type":void 0}}).success(function(n){e.showloadingBar=!1,i.info(n.message),e.reloadableTopupTable(),t.$broadcast(s.getBalanceAndRewards)}).error(function(n){e.showloadingBar=!1,i.error(n.error_message),e.reloadableTopupTable(),t.$broadcast(s.getBalanceAndRewards)})},e.proceedTopup=function(o){e.showloadingBar=!0,n({method:"POST",url:"/api/web/auth/bulk_payment/excel/payment/"+o+"/process",data:{},headers:{"Content-type":void 0}}).success(function(n){e.showloadingBar=!1,i.info(n.message),e.reloadableTopupTable(),t.$broadcast(s.getBalanceAndRewards)}).error(function(n){e.showloadingBar=!1,i.error(n.error_message),e.reloadableTopupTable(),t.$broadcast(s.getBalanceAndRewards)})},e.showStatement=function(e){c.open({templateUrl:u.url+"/html/payment/transaction_details_3.51.0.0.html",size:"lg",controller:"StatementDetailPopupController",resolve:{txnCode:function(){return e},moduleId:function(){return 1},transaction_version:function(){return"V3"}}})}}])}();